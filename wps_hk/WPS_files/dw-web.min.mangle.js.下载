!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("dw",n):(t="undefined"!=typeof globalThis?globalThis:t||self).dw=n()}(this,(function(){"use strict";function t(t){return t&&t.t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t){if(t.t)return t;var n=Object.defineProperty({},"t",{value:!0});return Object.keys(t).forEach((function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{i:!0,get:function(){return t[i]}})})),n}var i={},r={};Object.defineProperty(r,"t",{value:!0}),r.o=void 0,r.o=function(t,n){void 0===n&&(n="3.0.27");var i=/(\d+)\.(\d+)\.(\d+)/,r=t.match(i),e=n.match(i);if(!r||!e)return console.error("[dw-js-sdk] 传入版本错误! from="+t+" to="+n),0;for(var o=1;o<4;o++){var s=parseInt(r[o]),u=parseInt(e[o]);if(s!==u)return u>s?1:-1}return 0};var e={},o=function(t,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},o(t,n)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var s=function(){return s=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},s.apply(this,arguments)};var u=Object.create?function(t,n,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{i:!0,get:function(){return n[i]}})}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]};function a(t){var n="function"==typeof Symbol&&Symbol.iterator,i=n&&t[n],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,n){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,e,o=i.call(t),s=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=o.u)&&i.call(o)}finally{if(e)throw e.error}}return s}function h(t){return this instanceof h?(this.h=t,this):new h(t)}var f=Object.create?function(t,n){Object.defineProperty(t,"default",{i:!0,value:n})}:function(t,n){t.default=n};var v=Object.freeze({__proto__:null,v:function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)},get l(){return s},p:function(t,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(r=Object.getOwnPropertySymbols(t);e<r.length;e++)n.indexOf(r[e])<0&&Object.prototype.propertyIsEnumerable.call(t,r[e])&&(i[r[e]]=t[r[e]])}return i},_:function(t,n,i,r){var e,o=arguments.length,s=o<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,i,r);else for(var u=t.length-1;u>=0;u--)(e=t[u])&&(s=(o<3?e(s):o>3?e(n,i,s):e(n,i))||s);return o>3&&s&&Object.defineProperty(n,i,s),s},m:function(t,n){return function(i,r){n(i,r,t)}},g:function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},j:function(t,n,i,r){return new(i||(i=Promise))((function(e,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.O(t))}catch(t){o(t)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(t){t(n)}))).then(s,u)}a((r=r.apply(t,n||[])).next())}))},D:function(t,n){var i,r,e,o,s={label:0,k:function(){if(1&e[0])throw e[1];return e[1]},S:[],A:[]};return o={next:u(0),O:u(1),u:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(e=2&o[0]?r.u:o[0]?r.O||((e=r.u)&&e.call(r),0):r.next)&&!(e=e.call(r,o[1])).done)return e;switch(r=0,e&&(o=[2&o[0],e.value]),o[0]){case 0:case 1:e=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.A.pop(),s.S.pop();continue;default:if(!(e=s.S,(e=e.length>0&&e[e.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!e||o[1]>e[0]&&o[1]<e[3])){s.label=o[1];break}if(6===o[0]&&s.label<e[1]){s.label=e[1],e=o;break}if(e&&s.label<e[2]){s.label=e[2],s.A.push(o);break}e[2]&&s.A.pop(),s.S.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],r=0}finally{i=e=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},P:u,M:function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||u(n,t,i)},B:a,I:c,C:function(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(c(arguments[n]));return t},F:function(){for(var t=0,n=0,i=arguments.length;n<i;n++)t+=arguments[n].length;var r=Array(t),e=0;for(n=0;n<i;n++)for(var o=arguments[n],s=0,u=o.length;s<u;s++,e++)r[e]=o[s];return r},T:function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||(r||(r=Array.prototype.slice.call(n,0,e)),r[e]=n[e]);return t.concat(r||n)},R:h,N:function(t,n,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=i.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){e[t]&&(r[t]=function(n){return new Promise((function(i,r){o.push([t,n,i,r])>1||u(t,n)}))})}function u(t,n){try{(i=e[t](n)).value instanceof h?Promise.resolve(i.value.h).then(a,c):f(o[0][2],i)}catch(t){f(o[0][3],t)}var i}function a(t){u("next",t)}function c(t){u("throw",t)}function f(t,n){t(n),o.shift(),o.length&&u(o[0][0],o[0][1])}},K:function(t){var n,i;return n={},r("next"),r("throw",(function(t){throw t})),r("return"),n[Symbol.iterator]=function(){return this},n;function r(r,e){n[r]=t[r]?function(n){return(i=!i)?{value:h(t[r](n)),done:"return"===r}:e?e(n):n}:e}},U:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=t[Symbol.asyncIterator];return i?i.call(t):(t=a(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(n){return new Promise((function(r,e){(function(t,n,i,r){Promise.resolve(r).then((function(n){t({value:n,done:i})}),n)})(r,e,(n=t[i](n)).done,n.value)}))}}},V:function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},J:function(t){if(t&&t.t)return t;var n={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&u(n,t,i);return f(n,t),n},W:function(t){return t&&t.t?t:{default:t}},q:function(t,n,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof n?t!==n||!r:!n.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(t):r?r.value:n.get(t)},X:function(t,n,i,r,e){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!e)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof n?t!==n||!e:!n.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?e.call(t,i):e?e.value=i:n.set(t,i),i}}),l=n(v),d={exports:{}};
/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */
!function(t,n){!function(i){var r=n,e=t&&t.exports==r&&t,o="object"==typeof global&&global;o.global!==o&&o.window!==o||(i=o);var s=function(t){this.message=t};(s.prototype=new Error).name="InvalidCharacterError";var u=function(t){throw new s(t)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,h={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&u("The string to be encoded contains characters outside of the Latin1 range.");for(var n,i,r,e,o=t.length%3,s="",c=-1,h=t.length-o;++c<h;)n=t.charCodeAt(c)<<16,i=t.charCodeAt(++c)<<8,r=t.charCodeAt(++c),s+=a.charAt((e=n+i+r)>>18&63)+a.charAt(e>>12&63)+a.charAt(e>>6&63)+a.charAt(63&e);return 2==o?(n=t.charCodeAt(c)<<8,i=t.charCodeAt(++c),s+=a.charAt((e=n+i)>>10)+a.charAt(e>>4&63)+a.charAt(e<<2&63)+"="):1==o&&(e=t.charCodeAt(c),s+=a.charAt(e>>2)+a.charAt(e<<4&63)+"=="),s},decode:function(t){var n=(t=String(t).replace(c,"")).length;n%4==0&&(n=(t=t.replace(/==?$/,"")).length),(n%4==1||/[^+a-zA-Z0-9/]/.test(t))&&u("Invalid character: the string to be decoded is not correctly encoded.");for(var i,r,e=0,o="",s=-1;++s<n;)r=a.indexOf(t.charAt(s)),i=e%4?64*i+r:r,e++%4&&(o+=String.fromCharCode(255&i>>(-2*e&6)));return o},version:"1.0.0"};if(r&&!r.nodeType)if(e)e.exports=h;else for(var f in h)h.hasOwnProperty(f)&&(r[f]=h[f]);else i.G=h}(this)}(d,d.exports);var p={};
/*! https://mths.be/utf8js v3.0.0 by @mathias */!function(t){!function(t){var n,i,r,e=String.fromCharCode;function o(t){for(var n,i,r=[],e=0,o=t.length;e<o;)(n=t.charCodeAt(e++))>=55296&&n<=56319&&e<o?56320==(64512&(i=t.charCodeAt(e++)))?r.push(((1023&n)<<10)+(1023&i)+65536):(r.push(n),e--):r.push(n);return r}function s(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function u(t,n){return e(t>>n&63|128)}function a(t){if(0==(4294967168&t))return e(t);var n="";return 0==(4294965248&t)?n=e(t>>6&31|192):0==(4294901760&t)?(s(t),n=e(t>>12&15|224),n+=u(t,6)):0==(4292870144&t)&&(n=e(t>>18&7|240),n+=u(t,12),n+=u(t,6)),n+=e(63&t|128)}function c(){if(r>=i)throw Error("Invalid byte index");var t=255&n[r];if(r++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(){var t,e;if(r>i)throw Error("Invalid byte index");if(r==i)return!1;if(t=255&n[r],r++,0==(128&t))return t;if(192==(224&t)){if((e=(31&t)<<6|c())>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&t)){if((e=(15&t)<<12|c()<<6|c())>=2048)return s(e),e;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&e<=1114111)return e;throw Error("Invalid UTF-8 detected")}t.version="3.0.0",t.encode=function(t){for(var n=o(t),i=n.length,r=-1,e="";++r<i;)e+=a(n[r]);return e},t.decode=function(t){n=o(t),i=n.length,r=0;for(var s,u=[];!1!==(s=h());)u.push(s);return function(t){for(var n,i=t.length,r=-1,o="";++r<i;)(n=t[r])>65535&&(o+=e((n-=65536)>>>10&1023|55296),n=56320|1023&n),o+=e(n);return o}(u)}}(t)}(p);var w={},b={};Object.defineProperty(b,"t",{value:!0}),b.H=void 0;b.H=function(t,n){if("boolean"!=typeof t)throw Error("sdk error: "+n+" only accept argument of a type of Boolean!");return!0};var y={};Object.defineProperty(y,"t",{value:!0}),y.L=void 0;y.L=function(t){if("string"!=typeof t&&"number"!=typeof t)throw Error("sdk error: _dw.setDeviceKey(deviceId) call error, deviceId should be type of String or Number");return!0};var _={};Object.defineProperty(_,"t",{value:!0}),_.Z=void 0;_.Z=function(t,n){if("string"!=typeof t)throw Error("sdk error: "+n+" only accept argument of a type of String!");return!0};var m={},g={};Object.defineProperty(g,"t",{value:!0}),g.Y=void 0,g.Y=function(t){return JSON.parse(JSON.stringify(t))},Object.defineProperty(m,"t",{value:!0}),m.$=void 0;var E=g,j=function(){function t(t){this.tt=t,this.data=this.nt()}return t.prototype.nt=function(){var t=this.tt.it;return{protocol:11,st:"js",sv:"3.0.27",accountId:"",deviceId:"",appKey:t.appKey||"",channel:"default_channel",version:t.appVersion||"default_version",dbg:t.debugMode||!1,dbgUrl:"",customPublicAttrs:{},customPV:t.customPV||!1,defaultEvents:!0,rt:t.rt||!1}},t.prototype.et=function(t){if("string"!=typeof t)throw Error("[dw error] config key should be string.");if(!(t in this.data))throw Error("[dw error] the key '"+t+" is invalid.'")},t.prototype.set=function(t,n){this.et(t),this.data[t]=n},t.prototype.get=function(t){return this.et(t),this.data[t]},t.prototype.getAll=function(){return E.Y(this.data)},t.prototype.setCustomPublicAttrs=function(t,n){this.data.customPublicAttrs[t]=n},t}();m.$=j;var O={},D={};Object.defineProperty(D,"t",{value:!0}),D.ot=void 0;var k=function(){function t(){}return t.prototype.ut=function(){return this.stopped=!0,this},t.prototype.ct=function(){return this.stopped=!1,this},t.prototype.ht=function(){return this.stopped},t}();D.ot=k;var S={};Object.defineProperty(S,"t",{value:!0}),S.ft=void 0,S.ft=function(t){var n=function(t){return t<10?"0"+t:t},i=t,r=[i.getFullYear(),i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,n(i.getDate())].join("-"),e=n(i.getHours()),o=n(i.getMinutes()),s=n(i.getSeconds()),u=i.getMilliseconds().toString(),a=u.length<3?"000".slice(0,3-u.length)+u:u;return[r,[e,o,s].join(":")+"."+a,"+0800"].join(" ")};var A={};Object.defineProperty(A,"t",{value:!0}),A.vt=void 0,A.vt=function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return""+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()};var P={};Object.defineProperty(P,"t",{value:!0}),P.lt=void 0,P.lt=function(){try{if("undefined"!=typeof document&&"string"==typeof document.cookie)return/SESS\w*ID=([^;]+)/i.test(document.cookie)?RegExp.$1:""}catch(t){}return""};var M={};var B=Object.freeze({__proto__:null,default:function(t){return{all:t=t||new Map,on:function(n,i){var r=t.get(n);r&&r.push(i)||t.set(n,[i])},dt:function(n,i){var r=t.get(n);r&&r.splice(r.indexOf(i)>>>0,1)},wt:function(n,i){(t.get(n)||[]).slice().map((function(t){t(i)})),(t.get("*")||[]).slice().map((function(t){t(n,i)}))}}}}),I=n(B),C={},F={};!function(t){var n,i;Object.defineProperty(t,"t",{value:!0}),t.bt=void 0,n=t.bt||(t.bt={}),(i=n._t||(n._t={})).yt="GET",i.gt="POST",i.Et="jsonp"}(F),Object.defineProperty(C,"t",{value:!0}),C.jt=void 0;var x=l,T=F,R=function(t){function n(n){var i=t.call(this)||this;return i.dwProcess=n,i.Ot=0,i.Dt=0,i.redirectCount=0,i}return x.v(n,t),n.prototype.read=function(){return this.kt=this.dwProcess.At.St(),this},n.prototype.save=function(t){return this.dwProcess.At.Pt(t)},n.prototype.remove=function(){return this.kt=null,this.dwProcess.At.Mt()},n.prototype.Bt=function(){return x.j(this,void 0,void 0,(function(){var t,n,i,r,e;return x.D(this,(function(o){switch(o.label){case 0:return this.kt?[4,this.kt]:[2,!0];case 1:return(t=o.k())&&t.serverTime?(n=this.dwProcess.It())?[3,3]:[4,this.dwProcess.At.Ct()]:[2,!0];case 2:if(!(i=o.k()))return[2,!0];this.dwProcess.Ft=i,o.label=3;case 3:return r=new Date(t.serverTime),e=null!=n?n:this.dwProcess.It(),[2,r.toLocaleDateString()!==e.toLocaleDateString()]}}))}))},n.prototype.xt=function(t,n){var i,r,e,o,s,u;return void 0===t&&(t={}),x.j(this,void 0,void 0,(function(){return x.D(this,(function(a){return[2,{appVersion:t.version,sendUrlVersion:null!==(r=null===(i=null==n?void 0:n.sendUrls)||void 0===i?void 0:i.version)&&void 0!==r?r:0,transportControlVersion:null!==(o=null===(e=null==n?void 0:n.uploadStrategy)||void 0===e?void 0:e.version)&&void 0!==o?o:0,eventsVersion:null!==(u=null===(s=null==n?void 0:n.events)||void 0===s?void 0:s.version)&&void 0!==u?u:0,abTestName:"",abTestGroupId:""}]}))}))},n.prototype.body=function(){var t=this,n=this.dwProcess.Tt;return this.kt?this.Rt=this.kt.then((function(i){return t.xt(n.getAll(),null!=i?i:{})})):this.Rt=this.xt(n.getAll()),this},n.prototype.Nt=function(t){return x.j(this,void 0,void 0,(function(){var n,i,r,e,o,s,u,a=this;return x.D(this,(function(c){switch(c.label){case 0:return this.Rt?this.ht()?[2]:(n=this.dwProcess.Tt.get("appKey"))?this.Ot>=parseInt("15")||this.redirectCount>=parseInt("10")?[4,this.zt().remove()]:[3,2]:(this.Dt<parseInt("60")?(this.Dt++,this.retry()):console.error('[dw-js-sdk] appKey not be detected, please set the appKey by "dw.setAppKey()"!'),[2]):(console.error("[dw-js-sdk] dwDynamic.body() needs to be invoked"),[2]);case 1:return c.k(),console.error("[dw-js-sdk] requestDynamic failed for max connect count!"),[2];case 2:return t?(this.url=t,[3,7]):[3,3];case 3:return i=this.dwProcess.tt,r=i.it,(e=i.fixed).dynamicUrl?(this.url=e.dynamicUrl,[3,7]):[3,4];case 4:return this.kt?[4,this.kt]:[3,6];case 5:return(o=c.k())&&o.dynamicUrl?this.url=o.dynamicUrl:this.url=r.dynamicUrl,[3,7];case 6:this.url=r.dynamicUrl,c.label=7;case 7:return this.dwProcess.wt("before-dynamic-send",{Kt:this,dwProcess:this.dwProcess}),this.ht()?[2]:[4,this.Rt];case 8:return s=c.k(),u=this.url+"/api/dynamicParam/v1/app/"+n,this.dwProcess.tt.Vt.Ut.send(u,{type:T.bt._t.Et,timeout:parseInt("3000"),data:s},(function(t,n){return x.j(a,void 0,void 0,(function(){var i,r=this;return x.D(this,(function(e){return i=function(t){r.dwProcess.wt("after-dynamic-send",{Kt:r,dwProcess:r.dwProcess,Jt:t})},t||!n?(this.Ot++,this.retry(this.url),i(),[2]):"object"==typeof n&&1===Object.keys(n).length&&n.dynamicUrl?(this.redirectCount++,this.retry(n.dynamicUrl,0),i(),[2]):(this.data=Promise.resolve(n),this.zt().qt(n).Wt().data.then(i),[2])}))}))})),[2]}}))}))},n.prototype.retry=function(t,n){var i=this;return void 0===n&&(n=parseInt("1000")),this.zt(),this.Xt=setTimeout((function(){i.ct(),i.Nt(t)}),n),this},n.prototype.zt=function(){return clearTimeout(this.Xt),this},n.prototype.Wt=function(t){var n=this,i=this.dwProcess;return this.data?(this.data=this.data.then((function(r){return x.j(n,void 0,void 0,(function(){return x.D(this,(function(n){switch(n.label){case 0:return r?t?[3,2]:(r.Gt=Date.now(),[4,this.save(r)]):(console.error("[dw-js-sdk] dynamic data resolved is null"),[2,r]);case 1:n.k(),n.label=2;case 2:return r.serverTime&&(r.Gt?(i.Ft=r.serverTime-r.Gt,i.At.Ht(i.Ft)):i.At.Ct().then((function(t){i.Ft=null!=t?t:0}))),[2,r]}}))}))})),this):(console.error("[dw-js-sdk] dynamic data is not resolved"),this)},n.prototype.qt=function(t){return this.data=this.kt?this.kt.then((function(n){if(n){var i={};try{for(var r in t){var e=r,o=t[e];"[object Object]"!==Object.prototype.toString.call(o)?i[e]=o:i[e]=Object.assign({},n[e],o)}}catch(t){}return i}return t})):Promise.resolve(t),this},n.prototype.Lt=function(){var t=this,n=this.dwProcess;return this.data=this.kt.then((function(t){return t})),this.Wt(!0),this.data.then((function(i){n.wt("after-dynamic-send",{Kt:t,dwProcess:n,Jt:i})})),this},n}(D.ot);C.jt=R,Object.defineProperty(M,"t",{value:!0}),M.Qt=void 0;var N=l,z=N.W(I),K=C,U=O,V=function(){function t(n,i,r,e){this.tt=n,this.Tt=i,this.At=r,this.Zt=e,this.state="prepare",this.cache={Yt:[],$t:{},tn:{}},this.Kt=new K.jt(this),this.nn=z.default(),t.rn.push(this)}return t.prototype.It=function(t){if(void 0===t&&(t=new Date),null!=this.Ft){var n=t.getTime()+this.Ft,i=60*(new Date).getTimezoneOffset()*1e3,r=new Date;return r.setTime(n+i+288e5),r}},t.prototype.sendPageView=function(){var n=this.tt.Vt.en,i=this.cache.$t,r=new U.sn("_page_view",N.l(N.l(N.l({},i.un),i.an),{title:n.cn(),url:n.hn(),refer:n.fn()}),this);return t.vn("Process","sendPageView","",r),r.Nt()},t.prototype.ln=function(t){return void 0===t&&(t={}),N.j(this,void 0,void 0,(function(){var n,i,r;return N.D(this,(function(e){switch(e.label){case 0:return[4,this.At.dn()];case 1:return n=e.k(),i=this.cache.$t,n&&this.At.pn(),r=new U.sn("_app_start",N.l(N.l(N.l(N.l({},i.un),i.wn),{is_first_time:n.toString(),start_type:this.bn?"2":"1",resume_from_background:"false"}),t),this),this.yn||(this.yn=new Date),[2,r.Nt()]}}))}))},t.prototype._n=function(t){var n=this;void 0===t&&(t={});var i=[],r=this.cache.$t;return this.cache.Yt.forEach((function(t){t.mn=new Date,t.gn=n.It(t.mn)})),i.push.apply(i,N.T([],N.I(this.cache.Yt))),new U.sn("_app_end",N.l(N.l(N.l(N.l({},r.un),r.En),{use_duration:this.yn?Date.now()-this.yn.getTime():0}),t),this,null,i).body()},t.prototype.jn=function(t){void 0===t&&(t={});var n=this._n(t);return this.bn=!0,n.Nt()},t.prototype.On=function(){return N.j(this,void 0,void 0,(function(){var n;return N.D(this,(function(i){switch(i.label){case 0:return this.state="prepare",t.vn("Process","prepare","preparing"),[4,new Promise((function(t){return setTimeout(t)}))];case 1:return i.k(),[4,this.tt.Vt.en.Dn()];case 2:return i.k(),n=this.cache,[4,this.At.kn(this.Tt.get("appKey"),this.Tt)];case 3:return n.deviceId=i.k(),[4,this.At.Sn(this)];case 4:return i.k(),t.vn("Process","prepare","prepare done"),this.state="normal",[2]}}))}))},t.prototype.refresh=function(n){var i;return N.j(this,void 0,void 0,(function(){var r,e;return N.D(this,(function(o){switch(o.label){case 0:return this.state="prepare",this.wt("before-refresh",{dwProcess:this}),r=null!==(i=this.It())&&void 0!==i?i:new Date,e=this.yn&&r.toDateString()!==this.yn.toDateString()||n,this.Tt.get("defaultEvents")&&e?[4,this.jn()]:[3,2];case 1:o.k(),o.label=2;case 2:return[4,this.init({An:!0,Pn:n})];case 3:return o.k(),t.vn("Process","refresh","",{Mn:r,yn:this.yn},!0),this.state="normal",[2]}}))}))},t.prototype.init=function(n){var i,r;return void 0===n&&(n={}),N.j(this,void 0,void 0,(function(){var e,o,s,u=this;return N.D(this,(function(a){switch(a.label){case 0:return this.state="prepare",t.vn("Process","init"),this.Tt.get("defaultEvents")?(e=function(){return N.j(u,void 0,void 0,(function(){var n;return N.D(this,(function(i){return(n=[]).push(this.ln()),this.Tt.get("customPV")||n.push(this.sendPageView()),t.vn("Process","init","sending defaultEvent",n),[2,Promise.all(n)]}))}))},n.An&&this.yn||n.Pn?(o=null!==(i=this.It())&&void 0!==i?i:new Date,t.vn("Process","init","fresh",{yn:this.yn,Mn:o,Pn:n.Pn}),o.toDateString()!==this.yn.toDateString()||n.Pn?(this.yn=null,this.bn=!1,[4,e()]):[3,2]):[3,3]):[3,6];case 1:a.k(),a.label=2;case 2:return[3,5];case 3:return[4,e()];case 4:a.k(),a.label=5;case 5:null===(r=this.tt.it)||void 0===r||r.Bn(this,n),a.label=6;case 6:n.An||(this.on("after-dynamic-send",(function(n){n.Jt&&(u.Jt=n.Jt,u.state="normal",t.vn("Process","init","sending allStorages"),u.In())})),this.on("after-event-send",(function(n){(null==n?void 0:n.response)&&!n.response.error&&(clearTimeout(s),s=setTimeout((function(){t.rn.forEach((function(t){return t.In()}))}),800))}))),a.label=7;case 7:return a.S.push([7,11,,13]),this.Tt.get("dbg")?(this.Kt.read().body().Nt(),[3,10]):[3,8];case 8:return[4,this.Kt.read().Bt()];case 9:a.k()?(t.vn("Process","init","getting dwDynamic"),this.Kt.body().Nt()):this.Kt.Lt(),a.label=10;case 10:return[3,13];case 11:return a.k(),[4,this.Kt.remove()];case 12:return a.k(),this.Kt.body().retry(),[3,13];case 13:return[2]}}))}))},t.prototype.In=function(){this.Zt.Cn(this),this.Zt.Fn(this),this.Zt.xn(this)},t.vn=function(t,n,i,r,e,o){void 0===i&&(i="");try{((null===globalThis||void 0===globalThis?void 0:globalThis.dw_print_debug_log)||o)&&console.log("%c js-sdk-3.0.27 %c "+t+"-"+n+" %c "+(i||"")+"%c ","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background: "+(e?"#e5447a":"#41b883")+" ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent; font-weight: bolder","font-weight: normal",r||"")}catch(t){}},t.prototype.Tn=function(){return this.Tt.get("dbg")},t.prototype.on=function(t,n){return this.nn.on(t,n),this},t.prototype.dt=function(t,n){return this.nn.dt(t,n),this},t.prototype.wt=function(t,n){return this.nn.wt(t,n),this},t.rn=[],t}();M.Qt=V,Object.defineProperty(O,"t",{value:!0}),O.sn=void 0;var J=l,W=S,q=A,X=P,G=M,H=function(t){function n(n,i,r,e,o){var s,u,a,c,h,f,v,l,d;void 0===o&&(o=[]);var p=t.call(this)||this;return p.name=n,p.data=i,p.dwProcess=r,p.Rn=e,p.Nn=o,p.id=null!==(u=null===(s=p.Rn)||void 0===s?void 0:s.id)&&void 0!==u?u:q.vt(),p.from=null!==(c=null===(a=p.Rn)||void 0===a?void 0:a.from)&&void 0!==c?c:"event",p.position="event",p.zn=null!==(f=null===(h=p.Rn)||void 0===h?void 0:h.count)&&void 0!==f?f:0,p.urls=null===(v=p.Rn)||void 0===v?void 0:v.urls,G.Qt.vn("Event","constructor","generatingEvent",p),e?(null!==(l=p.name)&&void 0!==l||(p.name=e.name),null!==(d=p.data)&&void 0!==d||(p.data=e.data),p.mn=e.Gt?new Date(e.Gt):new Date,p.gn=e.Kn?new Date(e.Kn):r.It(p.mn)):(p.mn=new Date,p.gn=r.It(p.mn)),p.urls||p.Un(),G.Qt.vn("Event","constructor","generatedEvent",p),p}return J.v(n,t),Object.defineProperty(n.prototype,"Vn",{get:function(){return[this.urls.replace(/^\(|\)$/g,"").split(" ")[0]]},i:!1,Jn:!0}),n.prototype.Un=function(){var t,n,i,r,e,o,s=this.dwProcess,u=s.Tt,a=s.Jt,c=s.tt,h=null!==(n=null===(t=null==a?void 0:a.sendUrls)||void 0===t?void 0:t.urls)&&void 0!==n?n:c.it.sendUrl,f=c.it.debugUrl,v=u.getAll(),l=h;if(v.dbg)l=v.dbgUrl||(null===(i=null==a?void 0:a.sendUrls)||void 0===i?void 0:i.debugUrls)||f;else for(var d=null!==(o=null===(e=null===(r=null==a?void 0:a.events)||void 0===r?void 0:r.data)||void 0===e?void 0:e.length)&&void 0!==o?o:0,p=0;p<d;p++){var w=a.events.data[p];if(w.name===this.name){l=(null==w?void 0:w.sendUrls)||h;break}}return G.Qt.vn("Event","generateEventUrls","",{urls:l,name:this.name}),this.urls=l,this},n.prototype.Wn=function(){var t,n,i,r,e,o,s,u,a=this.dwProcess,c=a.Jt;this.gn||(this.gn=a.It(this.mn)),!this.qn&&this.data&&a.wt("event-data-encrypt",{Xn:this,dwProcess:a,Gn:this.data});var h={_time:W.ft(null!==(n=this.gn)&&void 0!==n?n:this.mn),_session_id:X.lt(),_event_id:this.id,_abtest_name:null!==(r=null===(i=null==c?void 0:c.abTestTag)||void 0===i?void 0:i.name)&&void 0!==r?r:"",_abtest_group_id:null!==(o=null===(e=null==c?void 0:c.abTestTag)||void 0===e?void 0:e.groupId)&&void 0!==o?o:""};return G.Qt.vn("Event","generateEventObject","",J.l(J.l({name:this.name},h),null!==(s=this.qn)&&void 0!==s?s:this.data)),(t={_type:"general"})[this.name]=J.l(J.l({},h),null!==(u=this.qn)&&void 0!==u?u:this.data),t},n.prototype.Hn=function(){var t=this.dwProcess.tt.Vt.en;return{_brand:t.Ln(),_os:t.Qn(),_model:t.Zn(),_screen:t.Yn(),_os_ver:t.$n(),_carrier:t.ti(),_network:t.ni(),_language:t.ii(),_gps:t.ri()}},n.prototype.ei=function(){var t,n=this.dwProcess,i=n.cache,r=n.Tt.getAll(),e=r.deviceId||i.deviceId,o=null!==(t=n.It())&&void 0!==t?t:new Date,s={_p:r.protocol,_st:r.st,_sv:r.sv,_app:r.appKey,_gid:e,_did:e,_aid:r.accountId,_ut:W.ft(o),_rid:q.vt(),_av:r.version,_ch:r.channel,_dbg:r.dbg,_add:this.Hn()};return Object.assign(s,r.customPublicAttrs),s},n.prototype.validate=function(){if(this.oi)return this;if(!this.name)throw Error('"_dw.onEvent(name, data)" call error, name is not allowed to be empty!');if(this.name&&"string"!=typeof this.name)throw Error('"_dw.onEvent(name, data)" call error, name should be String!');if(void 0!==this.data){var t=Object.prototype.toString.call(this.data).toLowerCase();if("[object object]"!==t&&"[object null]"!==t)throw Error('"_dw.onEvent(name, data)" call error, data should be Object!');for(var n in this.data)if(Object.prototype.hasOwnProperty.call(this.data,n)&&null!=this.data[n]&&!/string|boolean|number/.test(typeof this.data[n]))throw Error('"_dw.onEvent(name, data)" call error, value should be string/number/boolean!')}return this.oi=!0,this},n.prototype.body=function(){var t=this;if("wait"!==this.from&&this.validate(),!this.si){this.si=this.ei();try{this.events=this.si._events=this.data?[this.Wn()]:[]}catch(t){G.Qt.vn("Event","body","generatedEventBody-error",{event:this,error:t})}var n=function(i){i.forEach((function(i){var r;try{i.name&&t.events.push(i.Wn()),(null===(r=i.Nn)||void 0===r?void 0:r.length)&&n(i.Nn)}catch(n){G.Qt.vn("Event","body","combineEvents-generatedEventBody-error",{event:t,error:n})}}))};n(this.Nn),this.urls||this.Un()}return G.Qt.vn("Event","body","generatedEventBody",this),this},n.prototype.ui=function(t){for(var n,i,r,e=null!==(r=null===(i=null===(n=null==t?void 0:t.events)||void 0===n?void 0:n.data)||void 0===i?void 0:i.length)&&void 0!==r?r:0,o=0;o<e;o++){var s=t.events.data[o];if(this.name===s.name&&(!0===s.disable||"true"===s.disable))return!0}return!1},n.prototype.Nt=function(t){return J.j(this,void 0,void 0,(function(){var n,i,r,e,o=this;return J.D(this,(function(s){return n=this.dwProcess,i=n.Zt,r=n.Jt,t&&(this.urls=t),this.ht()?(G.Qt.vn("Event","post","event stopped",this,!0),[2,!1]):"prepare"===n.state?(G.Qt.vn("Event","post","process preparing",this,!0),this.ai(),[2,!1]):this.ui(r)?(G.Qt.vn("Event","post","event Expired",this,!0),[2,!1]):(n.wt("before-event-send",{Xn:this,dwProcess:n}),this.ht()?(G.Qt.vn("Event","post","event stopped 2",this,!0),[2,!1]):(this.body(),this.ci||n.wt("event-body-encrypt",{Xn:this,dwProcess:n,si:this.si}),e=this.ci,this.ht()?[2,!1]:[2,new Promise((function(t,r){var s=0,u=0,a=function(t,i){n.wt("after-event-send",{Xn:o,dwProcess:n,response:{error:t,data:i}})},c=function(){var n,r=o.Vn[s];if(!r)return t(!0);if("string"==typeof r)n=r;else{if(!(r.length>u))return u=0,s++,c();n=r[u]}i.hi(n,e,(function(i,e){i?s===o.Vn.length-1?(o.fi().log("event upload fail"),a(i,e),t(!1)):(s++,c()):"string"==typeof r||u===r.length-1?(o.log("event upload success",{url:n}),a(i,e),t(!0)):(u++,c())}))};c()}))]))}))}))},n.prototype.vi=function(){var t,n;return{id:this.id,name:this.name,from:this.from,Gt:this.mn.getTime(),Kn:null!==(n=null===(t=this.gn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0,data:this.data}},n.prototype.ai=function(){var t=this.dwProcess.At;return this.ct(),"cache"!==this.position&&(this.position="cache",G.Qt.vn("Event","saveCache","saving events",this),t.cache.save([this])),this},n.prototype.li=function(){G.Qt.vn("Event","saveWait","saving events",this);var t=this.dwProcess.At,n=[],i=function(t){"wait"!==t.position&&(t.position="wait",n.push(t))};return this.ct(),this.data&&i(this),this.Nn.forEach(i),t.wait.save(n),this},n.prototype.fi=function(){G.Qt.vn("Event","saveFail","saving events",this);var t=this.dwProcess.At,n=parseInt("10"),i=[],r=function(t){t.zn<n&&"fail"!==t.position&&(t.position="fail",i.push(t))};return this.ct(),this.data&&r(this),this.Nn.forEach(r),t.di.save(i),this},n.prototype.log=function(t,n){void 0===n&&(n={});var i=this.dwProcess,r=n.name,e=void 0===r?this.name:r,o=n.data,s=void 0===o?this.data:o,u=n.url,a=void 0===u?this.urls:u,c=n.body,h=void 0===c?this.si:c;return G.Qt.vn("LOG",t,"",{time:(new Date).toLocaleString(),name:e,data:s,url:a,length:h._events.length,body:h},!0,i.Tt.get("dbg")),this},n.prototype.pi=function(){this.data=null,this.Rn=null,this.Nn.length=0,this.qn=null,this.events=null,this.si=null,this.ci=null},n}(D.ot);O.sn=H;var L={},Q={};!function(t){var n,i;Object.defineProperty(t,"t",{value:!0}),t.Storage=void 0,n=t.Storage||(t.Storage={}),(i=n.bi||(n.bi={})).wi="dw_store_first_item_token",i.yi="dw_store_timestamp_key",i._i="dw_store_queen_data_events",i.mi="dw_store_wait_send_events",i.gi="dw_store_cache_events",i.Ei="dw_store_dynamic_data",i.ji="dw_store_time_sub",(n.Di||(n.Di={})).Oi="dw_store_device_id_key"}(Q),Object.defineProperty(L,"t",{value:!0}),L.ki=void 0;var Z=l,Y=Q,$=A,tt=O,nt=M,it=function(){function t(n,i,r){this.name=n,this.At=i,this.Si=r,this.data=[],this.Ai=0,t.rn.push(this)}return t.prototype.save=function(n){var i,r,e=t.rn,o=t.maxLength,s=e.reduce((function(t,n){return t+n.data.length}),0)+n.length-o;if(s<=0)(i=this.data).push.apply(i,Z.T([],Z.I(n)));else{var u=n.length-s;u>0&&(r=this.data).push.apply(r,Z.T([],Z.I(n.slice(0,u))))}this.Pi()},t.prototype.read=function(){return this.data},t.prototype.reset=function(){this.data=[],clearTimeout(this.Mi),this.sync()},t.prototype.sync=function(){return this.At.set(this.name,JSON.stringify(this.data.map(this.Si))).catch()},t.prototype.Pi=function(){var t=this,n=this.At,i=this.data;clearTimeout(this.Mi),this.Mi=setTimeout((function(){n.suffix?(t.Ai=0,n.set(t.name,JSON.stringify(i.map(t.Si))).catch()):(t.Ai<parseInt("60;")&&t.Pi(),t.Ai++)}),100)},t.prototype.Bi=function(t){var n=this;return this.At.get(this.name).then((function(i){var r;try{""===i&&(i="[]");var e=JSON.parse(i);(r=n.data).push.apply(r,Z.T([],Z.I(e.map((function(n){return new tt.sn(null,null,t,n)})))))}catch(t){nt.Qt.vn("Storage","resync","ERROR",t,!0),n.reset()}}))},t.rn=[],t.maxLength=parseInt("5000"),t}(),rt=function(){function t(t){this.tt=t,this.cache=new it(Y.Storage.bi.gi,this,(function(t){return Z.l({type:"cache"},t.vi())})),this.wait=new it(Y.Storage.bi.mi,this,(function(t){return Z.l({type:"wait",urls:t.urls},t.vi())})),this.di=new it(Y.Storage.bi._i,this,(function(t){return Z.l({type:"fail",urls:t.urls,count:t.zn+1},t.vi())}))}return t.prototype.Sn=function(t){return Promise.all([this.cache.Bi(t),this.wait.Bi(t),this.di.Bi(t)])},t.prototype.kn=function(t,n){return Z.j(this,void 0,void 0,(function(){var i,r,e,o,s,u,a,c,h,f,v,l,d,p,w,b,y;return Z.D(this,(function(_){switch(_.label){case 0:return i=this.tt.Vt,r=i.storage,e=i.en,[4,new Promise((function(t){return setTimeout(t)}))];case 1:return _.k(),o="web"===r.type,s=Y.Storage.Di.Oi,u=s+"@"+t,a=function(){var t=n.get("deviceId");return r.set(u,t),t},nt.Qt.vn("Storage","readDeviceId","",{deviceId:a()}),a()?[2,a()]:[4,e.Ii()];case 2:return c=_.k(),a()?[2,a()]:c?[2,c]:[4,r.get(s)];case 3:if(h=_.k(),a())return[2,a()];if(o){if(f=window.localStorage.getItem(u))return h||this.Ci(f,t,{un:"cover"}),[2,f];if(h)return this.Ci(h,t,{self:"cover"}),[2,h];for(v=s+"@",l=window.localStorage.length,d=0;d<l;d++)if(0===(p=window.localStorage.key(d)).indexOf(v)&&(w=window.localStorage.getItem(p)))return this.Ci(w,t,{un:"cover",self:"cover"}),[2,w];return b=$.vt(),this.Ci(b,t,{un:"cover",self:"cover"}),[2,b]}if(h)return[2,h];y=$.vt(),_.label=4;case 4:return _.S.push([4,6,,8]),[4,r.set(s,y)];case 5:return _.k(),[3,8];case 6:return _.k(),[4,this.kn(t,n)];case 7:return[2,_.k()];case 8:return[2,y]}}))}))},t.prototype.Ci=function(t,n,i){var r=this.tt.Vt.storage,e=Y.Storage.Di.Oi;if(nt.Qt.vn("Storage","syncDeviceId","",{Fi:i,deviceId:t,appKey:n}),"web"===r.type&&n){var o=e+"@"+n;switch(i.self){case"cover":r.set(o,t);break;case"fill":setTimeout((function(){r.get(o).then((function(n){!n&&r.set(o,t)}))}),50)}}switch(i.un){case"cover":r.set(e,t);break;case"fill":setTimeout((function(){r.get(e).then((function(n){!n&&r.set(e,t)}))}),50)}},t.prototype.xi=function(t){this.suffix=t},t.prototype.set=function(t,n){var i=this.Ti(t);return this.tt.Vt.storage.set(i,n)},t.prototype.get=function(t){var n=this.Ti(t);return this.tt.Vt.storage.get(n)},t.prototype.Ri=function(t){var n=this.Ti(t);return this.tt.Vt.storage.Ri(n)},t.prototype.Ti=function(t){return this.suffix?t+"_"+this.suffix:t},t.prototype.dn=function(){return Z.j(this,void 0,void 0,(function(){return Z.D(this,(function(t){switch(t.label){case 0:return[4,this.get(Y.Storage.bi.wi)];case 1:return[2,"true"!==t.k()]}}))}))},t.prototype.pn=function(){return this.set(Y.Storage.bi.wi,"true")},t.prototype.Pt=function(t){if("object"==typeof t)return this.set(Y.Storage.bi.Ei,JSON.stringify(t))},t.prototype.St=function(){return Z.j(this,void 0,void 0,(function(){var t;return Z.D(this,(function(n){switch(n.label){case 0:return n.S.push([0,2,,3]),[4,this.get(Y.Storage.bi.Ei)];case 1:return t=n.k(),[2,JSON.parse(t||"null")];case 2:return n.k(),[2,null];case 3:return[2]}}))}))},t.prototype.Mt=function(){return Z.j(this,void 0,void 0,(function(){return Z.D(this,(function(t){return[2,this.Ri(Y.Storage.bi.Ei)]}))}))},t.prototype.Ht=function(t){return void 0===t&&(t=0),this.set(Y.Storage.bi.ji,t.toString())},t.prototype.Ct=function(){return Z.j(this,void 0,void 0,(function(){var t;return Z.D(this,(function(n){switch(n.label){case 0:return[4,this.get(Y.Storage.bi.ji)];case 1:return t=n.k(),[2,parseInt(t||"0")]}}))}))},t}();L.ki=rt;var et={};Object.defineProperty(et,"t",{value:!0}),et.Ni=void 0;var ot=O,st=F,ut=M,at=function(){function t(t){this.tt=t}return t.prototype.Fn=function(t){var n=t.At,i=n.cache.read();n.cache.reset(),n.wait.save(i),i.length&&ut.Qt.vn("Service","sendCacheEvents","",i),this.Cn(t)},t.prototype.xn=function(t){var n=t.At,i=n.di.read();n.di.reset(),n.wait.save(i),i.length&&ut.Qt.vn("Service","sendFailEvents","",i),this.Cn(t)},t.prototype.Cn=function(n){var i,r,e,o,s=n.At,u=n.Jt,a=s.wait.read();if(a.length&&ut.Qt.vn("Service","sendWaitEvents","",a),a.length){s.wait.reset();var c={},h=(null!==(i=n.It())&&void 0!==i?i:new Date).getTime(),f=a.reduce((function(n,i){var r;return h-(null!==(r=i.gn)&&void 0!==r?r:i.mn).getTime()>t.zi||i.id in c||(c[i.id]=1,n[i.urls]||(n[i.urls]=[]),n[i.urls].push(i),i.position="event"),n}),{});ut.Qt.vn("Service","sendWaitEvents","eventMap",f);var v=null!==(o=null===(e=null===(r=null==u?void 0:u.uploadStrategy)||void 0===r?void 0:r.transportControl)||void 0===e?void 0:e.splitSize)&&void 0!==o?o:parseInt("100");for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l)){var d=f[l];ut.Qt.vn("Service","sendWaitEvents","newEvent-combineEvents",{key:l,events:d});for(var p=0;p<Math.ceil(d.length/v);p++)new ot.sn(null,null,n,{from:"wait"},d.slice(v*p,v*(p+1))).Nt()}}},t.prototype.hi=function(t,n,i){return this.tt.Vt.Ut.send(t,{type:st.bt._t.gt,data:n,Ki:{"dw-protocol":"1.0"},timeout:parseInt("3000")},i)},t.zi=2592e6,t}();et.Ni=at,Object.defineProperty(w,"t",{value:!0}),w.tt=void 0;var ct=l,ht=b,ft=y,vt=_,lt=m,dt=O,pt=M,wt=L,bt=et,yt=function(){function t(n){var i=this;void 0===n&&(n={}),this.options=n,this.dwProcess=new pt.Qt(t,new lt.$(t),new wt.ki(t),new bt.Ni(t)),this.version="3.0.27",t.Ui.length&&t.Ui.forEach((function(t){i.dwProcess.on(t.event,t.Vi)})),pt.Qt.vn("Reporter","init")}return t.Ji=function(t){for(var n=0;n<this.Ui.length;n++)if(this.Ui[n].name===t.name)return this;this.Ui.push(t)},t.use=function(t,n){t.Wi(this,n)},t.prototype.onEvent=function(t,n){void 0===n&&(n={}),pt.Qt.vn("Reporter","onEvent",t,n,!0),null===n&&(n={}),new dt.sn(t,n,this.dwProcess).validate().Nt()},t.prototype.setAccountId=function(t){return void 0===t&&(t=""),this.dwProcess.Tt.set("accountId",String(t)),pt.Qt.vn("Reporter","setAccountId",t),this},t.prototype.setAppKey=function(t){var n=this;if(t&&vt.Z(t,"dw.setAppKey(appKey)")){var i=t;this.options.qi&&(i+="_"+this.options.qi);var r=function(){n.dwProcess.At.xi(i),pt.Qt.vn("Reporter","setSuffix",i),n.dwProcess.On().then((function(){return n.dwProcess.init()}))};pt.Qt.rn.find((function(n){return n.Tt.get("appKey")===t}))?setTimeout((function(){return r()}),300):r(),pt.Qt.vn("Reporter","setAppKey",t),this.dwProcess.Tt.set("appKey",t)}return this},t.prototype.setChannel=function(t){return t&&vt.Z(t,"dw.setChannel(channel)")&&(this.dwProcess.Tt.set("channel",t),pt.Qt.vn("Reporter","setChannel",t)),this},t.prototype.setCustomPublicAttrs=function(t,n){if(pt.Qt.vn("Reporter","setCustomPublicAttrs","",t),t){if("string"==typeof t)return this.dwProcess.Tt.setCustomPublicAttrs(t,n),this;if("object"==typeof t)return this.dwProcess.Tt.set("customPublicAttrs",t),this}throw Error("sdk error: setCustomPublicAttrs(key, value) arguments error!")},t.prototype.setCustomPV=function(t){return ht.H(t,"dw.setCustomPV(bool)")&&(this.dwProcess.Tt.set("customPV",t),pt.Qt.vn("Reporter","setCustomPV","",t)),this},t.prototype.setDebug=function(t,n,i){return void 0===n&&(n=""),void 0===i&&(i=!1),ht.H(t,"dw.setDebug(debug, [url], noEncrypted)")&&this.dwProcess.Tt.set("dbg",t),n&&vt.Z(n,"dw.setDebug(debug, [url], noEncrypted)")&&this.dwProcess.Tt.set("dbgUrl",n),n&&ht.H(i,"dw.setDebug(debug, [url], noEncrypted)")&&this.dwProcess.Tt.set("noEncrypted",i),this},t.prototype.setDefaultEvents=function(t){return ht.H(t,"dw.setDefaultEvents(bool)")&&(this.dwProcess.Tt.set("defaultEvents",t),pt.Qt.vn("Reporter","setDefaultEvents","",t)),this},t.prototype.setDeviceKey=function(t){if(t&&ft.L(t)){var n=this.dwProcess,i=n.Tt,r=n.At;pt.Qt.vn("Reporter","setDeviceKey",t),i.set("deviceId",t),r.Ci(t,i.get("appKey"),{un:"fill",self:"fill"})}return this},t.prototype.Xi=function(t,n){void 0===n&&(n="common");var i=this.dwProcess;return new dt.sn("_setDefaultEventsData",t,i).validate(),pt.Qt.vn("Reporter","setDefaultEventsData","",{data:t,position:n}),i.cache.$t[n]=t,this},t.prototype.setAppEndExtraData=function(t,n){var i=this.dwProcess;return pt.Qt.vn("Reporter","setAppEndExtraData","",{data:n,name:t}),"string"==typeof t?i.cache.Yt.push(new dt.sn(t,n,i).validate()):i.cache.Yt=t.map((function(t){var n=ct.I(t,2),r=n[0],e=n[1];return new dt.sn(r,e,i).validate()})),this},t.prototype.setVersion=function(t){return t&&vt.Z(t,"dw.setVersion(version)")&&(this.dwProcess.Tt.set("version",t),pt.Qt.vn("Reporter","setVersion",t)),this},t.prototype.sendPageView=function(){return this.dwProcess.Tt.get("customPV")?this.dwProcess.sendPageView():console.error("[dw-js-sdk] sendPageView > 请先使用dw.setCustomPV(true)开启自定义pv"),this},t.prototype.on=function(t,n){return this.dwProcess.on(t,n),pt.Qt.vn("Reporter","on","",t),this},t.Vt={Ut:{},en:{},storage:{}},t.fixed={},t.it={},t.Ui=[],t}();w.tt=yt;var _t={},mt={};Object.defineProperty(mt,"t",{value:!0}),mt.Gi=mt.Hi=void 0;var gt=function(){function t(){}return t.prototype.Li=function(t){var n=[];for(var i in t){var r=t;n.push(encodeURIComponent(i)+"="+encodeURIComponent(r[i]))}return n.join("&")},t.prototype.transform=function(t,n){for(var i=0;i<n.length;i++){var r=n[i];"function"==typeof r&&(t=r(t))}return t},t.prototype.Qi=function(){return function(t){try{return JSON.parse(t.slice(t.indexOf("(")+1,t.length-1))}catch(n){return t}}},t}();mt.Gi=gt;var Et=function(){};mt.Hi=Et,Object.defineProperty(_t,"t",{value:!0}),_t.Zi=void 0;var jt=l,Ot=F,Dt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type="web",n.send=function(t,i,r){void 0===i&&(i={});var e=i.Yi,o=void 0===e?[]:e;i.type===Ot.bt._t.Et&&(i.type=Ot.bt._t.yt,o.unshift(n.Qi()));var s=function(t,n){s.$i||(s.$i=!0,r&&r(t,n))},u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");for(var a in i.type===Ot.bt._t.yt&&"object"==typeof i.data&&(t+=(t.includes("?")?"&":"?")+n.Li(i.data)),u.open(i.type,t),i.type===Ot.bt._t.gt&&u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.Ki)u.setRequestHeader(a,i.Ki[a]);u.onreadystatechange=function(){var t=u.status>=200&&u.status<=207;4===u.readyState&&t?s(null,u.responseText?n.transform(u.responseText,o):null):4!==u.readyState||t||0===u.status||s(new Error("http error 1: status not ok"))},u.onerror=function(){s(new Error("http error 2: onerror"))};try{u.timeout=i.timeout,u.ontimeout=function(){s(new Error("http error 3: timeout"))},u.send("object"==typeof i.data?JSON.stringify(i.data):i.data)}catch(t){s(new Error("http error 4: catch"))}return{cancel:function(){u.abort()}}},n}return jt.v(n,t),n}(mt.Gi);_t.Zi=Dt;var kt={},St={};Object.defineProperty(St,"t",{value:!0}),St.tr=void 0;var At=function(){};St.tr=At,Object.defineProperty(kt,"t",{value:!0}),kt.nr=void 0;var Pt=l,Mt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type="web",n.cache={info:{ir:!1,rr:null,er:null,sr:null,brand:null,os:null}},n}return Pt.v(n,t),n.prototype.Ln=function(){return this.cache.info.brand},n.prototype.Qn=function(){return this.cache.info.os||"unknown"},n.prototype.Zn=function(){return this.Ln()+"_"+(this.cache.info.ir?this.cache.info.rr:this.cache.info.sr)},n.prototype.Yn=function(){var t=screen.width,n=screen.height;return t&&n?t+"*"+n:""},n.prototype.$n=function(){return""},n.prototype.ti=function(){return""},n.prototype.ni=function(){return"wifi"},n.prototype.ii=function(){return navigator.language||"zh"},n.prototype.ri=function(){return""},n.prototype.ur=function(){return""},n.prototype.ar=function(){return"CN"},n.prototype.cn=function(){var t;return null!==(t=document.title)&&void 0!==t?t:""},n.prototype.hn=function(){var t;return null!==(t=location.href)&&void 0!==t?t:""},n.prototype.fn=function(){var t;return null!==(t=document.referrer)&&void 0!==t?t:""},n.prototype.Ii=function(){return""},n.prototype.Dn=function(t){void 0===t&&(t={});var n=t.cr,i=void 0===n?navigator.userAgent:n;if(this.cache.info.ir=/Android|webOS|iPhone|iPod|iPad|BlackBerry|windows phone/i.test(i))for(var r=[[/android|linux/i,"Android","Android"],[/iphone/i,"iPhone","iOS"],[/ipad/i,"iPad","iOS"],[/windows/i,"Windows Phone","Win mobile"],[null,"unknown","unknown"]],e=0;e<r.length;e++){var o=Pt.I(r[e],3),s=o[0],u=o[1],a=o[2];if(!s||s.test(i)){this.cache.info.rr=u,this.cache.info.os=this.cache.info.er=a;break}}else{u=navigator.platform?navigator.platform.toLowerCase():"";var c=[[/win/i,"Win"],[/mac/i,"MacOs"],[/linux/i,"Linux"],[null,"unknown"]];for(e=0;e<c.length;e++){var h=Pt.I(c[e],2);s=h[0],a=h[1];if(!s||s.test(u)){this.cache.info.os=this.cache.info.sr=a;break}}}var f=[[/msie/i,"IE"],[/rv:11.0/i,"IE"],[/edge/i,"Edge"],[/firefox|fxios/i,"Firefox"],[/qq/i,"QQ"],[/micromessenger|wechat/i,"Wechat"],[/2345/i,"2345"],[/lbbrowser|liebao/i,"Cheetah"],[/opr/i,"Opera"],[/ubrowser|ucbrowser/i,"UC"],[/bidubrowser|baidu/i,"Baidu"],[/metasr|sogou/i,"Sogou"],[/qihoobrowser|360ee|360se/i,"360"],[/chrome|crios/i,"Chrome"],[/safari|mac/i,"Safari"]];for(e=0;e<f.length;e++){var v=Pt.I(f[e],2),l=(s=v[0],v[1]);if(!s||s.test(i)){this.cache.info.brand=l;break}}return Promise.resolve(this.cache.info)},n}(St.tr);kt.nr=Mt;var Bt={};Object.defineProperty(Bt,"t",{value:!0}),Bt.hr=void 0;var It=function(){function t(){this.type="web"}return t.prototype.set=function(t,n){return window.localStorage.setItem(t,n),Promise.resolve()},t.prototype.get=function(t){var n;return Promise.resolve(null!==(n=window.localStorage.getItem(t))&&void 0!==n?n:"")},t.prototype.Ri=function(t){return window.localStorage.removeItem(t),Promise.resolve()},t}();Bt.hr=It;var Ct={},Ft={},xt={exports:{}},Tt={exports:{}},Rt=n(Object.freeze({__proto__:null,default:{}}));!function(t,n){var i;t.exports=(i=i||function(t,n){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&"undefined"!=typeof global&&global.crypto&&(i=global.crypto),!i)try{i=Rt}catch(t){}var r=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof i.vr)try{return i.vr(4).lr()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},e=Object.create||function(){function t(){}return function(n){var i;return t.prototype=n,i=new t,t.prototype=null,i}}(),o={},s=o.dr={},u=s.pr={extend:function(t){var n=e(this);return t&&n.wr(t),n.hasOwnProperty("init")&&this.init!==n.init||(n.init=function(){n.br.init.apply(this,arguments)}),n.init.prototype=n,n.br=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},wr:function(t){for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=s.yr=u.extend({init:function(t,i){t=this._r=t||[],this.mr=i!=n?i:4*t.length},toString:function(t){return(t||h).stringify(this)},concat:function(t){var n=this._r,i=t._r,r=this.mr,e=t.mr;if(this.gr(),r%4)for(var o=0;o<e;o++){var s=i[o>>>2]>>>24-o%4*8&255;n[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var u=0;u<e;u+=4)n[r+u>>>2]=i[u>>>2];return this.mr+=e,this},gr:function(){var n=this._r,i=this.mr;n[i>>>2]&=4294967295<<32-i%4*8,n.length=t.ceil(i/4)},clone:function(){var t=u.clone.call(this);return t._r=this._r.slice(0),t},random:function(t){for(var n=[],i=0;i<t;i+=4)n.push(r());return new a.init(n,t)}}),c=o.Er={},h=c.jr={stringify:function(t){for(var n=t._r,i=t.mr,r=[],e=0;e<i;e++){var o=n[e>>>2]>>>24-e%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var n=t.length,i=[],r=0;r<n;r+=2)i[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new a.init(i,n/2)}},f=c.Or={stringify:function(t){for(var n=t._r,i=t.mr,r=[],e=0;e<i;e++){var o=n[e>>>2]>>>24-e%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var n=t.length,i=[],r=0;r<n;r++)i[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new a.init(i,n)}},v=c.Dr={stringify:function(t){try{return decodeURIComponent(escape(f.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return f.parse(unescape(encodeURIComponent(t)))}},l=s.kr=u.extend({reset:function(){this.Sr=new a.init,this.Ar=0},Pr:function(t){"string"==typeof t&&(t=v.parse(t)),this.Sr.concat(t),this.Ar+=t.mr},Mr:function(n){var i,r=this.Sr,e=r._r,o=r.mr,s=this.blockSize,u=o/(4*s),c=(u=n?t.ceil(u):t.max((0|u)-this.Br,0))*s,h=t.min(4*c,o);if(c){for(var f=0;f<c;f+=s)this.Ir(e,f);i=e.splice(0,c),r.mr-=h}return new a.init(i,h)},clone:function(){var t=u.clone.call(this);return t.Sr=this.Sr.clone(),t},Br:0});s.Cr=l.extend({Fr:u.extend(),init:function(t){this.Fr=this.Fr.extend(t),this.reset()},reset:function(){l.reset.call(this),this.Tr()},update:function(t){return this.Pr(t),this.Mr(),this},Rr:function(t){return t&&this.Pr(t),this.Nr()},blockSize:16,zr:function(t){return function(n,i){return new t.init(i).Rr(n)}},Kr:function(t){return function(n,i){return new d.Ur.init(t,i).Rr(n)}}});var d=o.Vr={};return o}(Math),i)}(Tt);var Nt={exports:{}};!function(t,n){var i;t.exports=(i=Tt.exports,function(){var t=i,n=t.dr.yr;function r(t,i,r){for(var e=[],o=0,s=0;s<i;s++)if(s%4){var u=r[t.charCodeAt(s-1)]<<s%4*2|r[t.charCodeAt(s)]>>>6-s%4*2;e[o>>>2]|=u<<24-o%4*8,o++}return n.create(e,o)}t.Er.Jr={stringify:function(t){var n=t._r,i=t.mr,r=this.Wr;t.gr();for(var e=[],o=0;o<i;o+=3)for(var s=(n[o>>>2]>>>24-o%4*8&255)<<16|(n[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|n[o+2>>>2]>>>24-(o+2)%4*8&255,u=0;u<4&&o+.75*u<i;u++)e.push(r.charAt(s>>>6*(3-u)&63));var a=r.charAt(64);if(a)for(;e.length%4;)e.push(a);return e.join("")},parse:function(t){var n=t.length,i=this.Wr,e=this.qr;if(!e){e=this.qr=[];for(var o=0;o<i.length;o++)e[i.charCodeAt(o)]=o}var s=i.charAt(64);if(s){var u=t.indexOf(s);-1!==u&&(n=u)}return r(t,n,e)},Wr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),i.Er.Jr)}(Nt);var zt={exports:{}};!function(t,n){var i;t.exports=(i=Tt.exports,function(t){var n=i,r=n.dr,e=r.yr,o=r.Cr,s=n.Vr,u=[];!function(){for(var n=0;n<64;n++)u[n]=4294967296*t.abs(t.sin(n+1))|0}();var a=s.Xr=o.extend({Tr:function(){this.Gr=new e.init([1732584193,4023233417,2562383102,271733878])},Ir:function(t,n){for(var i=0;i<16;i++){var r=n+i,e=t[r];t[r]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8)}var o=this.Gr._r,s=t[n+0],a=t[n+1],l=t[n+2],d=t[n+3],p=t[n+4],w=t[n+5],b=t[n+6],y=t[n+7],_=t[n+8],m=t[n+9],g=t[n+10],E=t[n+11],j=t[n+12],O=t[n+13],D=t[n+14],k=t[n+15],S=o[0],A=o[1],P=o[2],M=o[3];S=c(S,A,P,M,s,7,u[0]),M=c(M,S,A,P,a,12,u[1]),P=c(P,M,S,A,l,17,u[2]),A=c(A,P,M,S,d,22,u[3]),S=c(S,A,P,M,p,7,u[4]),M=c(M,S,A,P,w,12,u[5]),P=c(P,M,S,A,b,17,u[6]),A=c(A,P,M,S,y,22,u[7]),S=c(S,A,P,M,_,7,u[8]),M=c(M,S,A,P,m,12,u[9]),P=c(P,M,S,A,g,17,u[10]),A=c(A,P,M,S,E,22,u[11]),S=c(S,A,P,M,j,7,u[12]),M=c(M,S,A,P,O,12,u[13]),P=c(P,M,S,A,D,17,u[14]),S=h(S,A=c(A,P,M,S,k,22,u[15]),P,M,a,5,u[16]),M=h(M,S,A,P,b,9,u[17]),P=h(P,M,S,A,E,14,u[18]),A=h(A,P,M,S,s,20,u[19]),S=h(S,A,P,M,w,5,u[20]),M=h(M,S,A,P,g,9,u[21]),P=h(P,M,S,A,k,14,u[22]),A=h(A,P,M,S,p,20,u[23]),S=h(S,A,P,M,m,5,u[24]),M=h(M,S,A,P,D,9,u[25]),P=h(P,M,S,A,d,14,u[26]),A=h(A,P,M,S,_,20,u[27]),S=h(S,A,P,M,O,5,u[28]),M=h(M,S,A,P,l,9,u[29]),P=h(P,M,S,A,y,14,u[30]),S=f(S,A=h(A,P,M,S,j,20,u[31]),P,M,w,4,u[32]),M=f(M,S,A,P,_,11,u[33]),P=f(P,M,S,A,E,16,u[34]),A=f(A,P,M,S,D,23,u[35]),S=f(S,A,P,M,a,4,u[36]),M=f(M,S,A,P,p,11,u[37]),P=f(P,M,S,A,y,16,u[38]),A=f(A,P,M,S,g,23,u[39]),S=f(S,A,P,M,O,4,u[40]),M=f(M,S,A,P,s,11,u[41]),P=f(P,M,S,A,d,16,u[42]),A=f(A,P,M,S,b,23,u[43]),S=f(S,A,P,M,m,4,u[44]),M=f(M,S,A,P,j,11,u[45]),P=f(P,M,S,A,k,16,u[46]),S=v(S,A=f(A,P,M,S,l,23,u[47]),P,M,s,6,u[48]),M=v(M,S,A,P,y,10,u[49]),P=v(P,M,S,A,D,15,u[50]),A=v(A,P,M,S,w,21,u[51]),S=v(S,A,P,M,j,6,u[52]),M=v(M,S,A,P,d,10,u[53]),P=v(P,M,S,A,g,15,u[54]),A=v(A,P,M,S,a,21,u[55]),S=v(S,A,P,M,_,6,u[56]),M=v(M,S,A,P,k,10,u[57]),P=v(P,M,S,A,b,15,u[58]),A=v(A,P,M,S,O,21,u[59]),S=v(S,A,P,M,p,6,u[60]),M=v(M,S,A,P,E,10,u[61]),P=v(P,M,S,A,l,15,u[62]),A=v(A,P,M,S,m,21,u[63]),o[0]=o[0]+S|0,o[1]=o[1]+A|0,o[2]=o[2]+P|0,o[3]=o[3]+M|0},Nr:function(){var n=this.Sr,i=n._r,r=8*this.Ar,e=8*n.mr;i[e>>>5]|=128<<24-e%32;var o=t.floor(r/4294967296),s=r;i[15+(e+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),i[14+(e+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n.mr=4*(i.length+1),this.Mr();for(var u=this.Gr,a=u._r,c=0;c<4;c++){var h=a[c];a[c]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return u},clone:function(){var t=o.clone.call(this);return t.Gr=this.Gr.clone(),t}});function c(t,n,i,r,e,o,s){var u=t+(n&i|~n&r)+e+s;return(u<<o|u>>>32-o)+n}function h(t,n,i,r,e,o,s){var u=t+(n&r|i&~r)+e+s;return(u<<o|u>>>32-o)+n}function f(t,n,i,r,e,o,s){var u=t+(n^i^r)+e+s;return(u<<o|u>>>32-o)+n}function v(t,n,i,r,e,o,s){var u=t+(i^(n|~r))+e+s;return(u<<o|u>>>32-o)+n}n.Xr=o.zr(a),n.Hr=o.Kr(a)}(Math),i.Xr)}(zt);var Kt={exports:{}},Ut={exports:{}};!function(t,n){var i,r,e,o,s,u,a,c;t.exports=(r=(i=c=Tt.exports).dr,e=r.yr,o=r.Cr,s=i.Vr,u=[],a=s.Lr=o.extend({Tr:function(){this.Gr=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},Ir:function(t,n){for(var i=this.Gr._r,r=i[0],e=i[1],o=i[2],s=i[3],a=i[4],c=0;c<80;c++){if(c<16)u[c]=0|t[n+c];else{var h=u[c-3]^u[c-8]^u[c-14]^u[c-16];u[c]=h<<1|h>>>31}var f=(r<<5|r>>>27)+a+u[c];f+=c<20?1518500249+(e&o|~e&s):c<40?1859775393+(e^o^s):c<60?(e&o|e&s|o&s)-1894007588:(e^o^s)-899497514,a=s,s=o,o=e<<30|e>>>2,e=r,r=f}i[0]=i[0]+r|0,i[1]=i[1]+e|0,i[2]=i[2]+o|0,i[3]=i[3]+s|0,i[4]=i[4]+a|0},Nr:function(){var t=this.Sr,n=t._r,i=8*this.Ar,r=8*t.mr;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=Math.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,t.mr=4*n.length,this.Mr(),this.Gr},clone:function(){var t=o.clone.call(this);return t.Gr=this.Gr.clone(),t}}),i.Lr=o.zr(a),i.Qr=o.Kr(a),c.Lr)}(Ut);var Vt={exports:{}};!function(t,n){var i,r,e;t.exports=(r=(i=Tt.exports).dr.pr,e=i.Er.Dr,void(i.Vr.Ur=r.extend({init:function(t,n){t=this.Zr=new t.init,"string"==typeof n&&(n=e.parse(n));var i=t.blockSize,r=4*i;n.mr>r&&(n=t.Rr(n)),n.gr();for(var o=this.Yr=n.clone(),s=this.$r=n.clone(),u=o._r,a=s._r,c=0;c<i;c++)u[c]^=1549556828,a[c]^=909522486;o.mr=s.mr=r,this.reset()},reset:function(){var t=this.Zr;t.reset(),t.update(this.$r)},update:function(t){return this.Zr.update(t),this},Rr:function(t){var n=this.Zr,i=n.Rr(t);return n.reset(),n.Rr(this.Yr.clone().concat(i))}})))}(Vt),function(t,n){var i,r,e,o,s,u,a,c;t.exports=(r=(i=c=Tt.exports).dr,e=r.pr,o=r.yr,s=i.Vr,u=s.Xr,a=s.te=e.extend({Fr:e.extend({ne:4,ie:u,re:1}),init:function(t){this.Fr=this.Fr.extend(t)},ee:function(t,n){for(var i,r=this.Fr,e=r.ie.create(),s=o.create(),u=s._r,a=r.ne,c=r.re;u.length<a;){i&&e.update(i),i=e.update(t).Rr(n),e.reset();for(var h=1;h<c;h++)i=e.Rr(i),e.reset();s.concat(i)}return s.mr=4*a,s}}),i.te=function(t,n,i){return a.create(i).ee(t,n)},c.te)}(Kt);var Jt={exports:{}};!function(t,n){var i;t.exports=void((i=Tt.exports).dr.oe||function(t){var n=i,r=n.dr,e=r.pr,o=r.yr,s=r.kr,u=n.Er;u.Dr;var a=u.Jr,c=n.Vr.te,h=r.oe=s.extend({Fr:e.extend(),se:function(t,n){return this.create(this.ue,t,n)},ae:function(t,n){return this.create(this.ce,t,n)},init:function(t,n,i){this.Fr=this.Fr.extend(i),this.he=t,this.fe=n,this.reset()},reset:function(){s.reset.call(this),this.Tr()},process:function(t){return this.Pr(t),this.Mr()},Rr:function(t){return t&&this.Pr(t),this.Nr()},ne:4,ve:4,ue:1,ce:2,zr:function(){function t(t){return"string"==typeof t?_:b}return function(n){return{encrypt:function(i,r,e){return t(r).encrypt(n,i,r,e)},decrypt:function(i,r,e){return t(r).decrypt(n,i,r,e)}}}}()});r.le=h.extend({Nr:function(){return this.Mr(!0)},blockSize:1});var f=n.mode={},v=r.de=e.extend({se:function(t,n){return this.pe.create(t,n)},ae:function(t,n){return this.we.create(t,n)},init:function(t,n){this.be=t,this.ye=n}}),l=f._e=function(){var n=v.extend();function i(n,i,r){var e,o=this.ye;o?(e=o,this.ye=t):e=this.me;for(var s=0;s<r;s++)n[i+s]^=e[s]}return n.pe=n.extend({ge:function(t,n){var r=this.be,e=r.blockSize;i.call(this,t,n,e),r.Ee(t,n),this.me=t.slice(n,n+e)}}),n.we=n.extend({ge:function(t,n){var r=this.be,e=r.blockSize,o=t.slice(n,n+e);r.je(t,n),i.call(this,t,n,e),this.me=o}}),n}(),d=(n.pad={}).Oe={pad:function(t,n){for(var i=4*n,r=i-t.mr%i,e=r<<24|r<<16|r<<8|r,s=[],u=0;u<r;u+=4)s.push(e);var a=o.create(s,r);t.concat(a)},De:function(t){var n=255&t._r[t.mr-1>>>2];t.mr-=n}};r.ke=h.extend({Fr:h.Fr.extend({mode:l,padding:d}),reset:function(){var t;h.reset.call(this);var n=this.Fr,i=n.Se,r=n.mode;this.he==this.ue?t=r.se:(t=r.ae,this.Br=1),this.Ae&&this.Ae.Pe==t?this.Ae.init(this,i&&i._r):(this.Ae=t.call(r,this,i&&i._r),this.Ae.Pe=t)},Ir:function(t,n){this.Ae.ge(t,n)},Nr:function(){var t,n=this.Fr.padding;return this.he==this.ue?(n.pad(this.Sr,this.blockSize),t=this.Mr(!0)):(t=this.Mr(!0),n.De(t)),t},blockSize:4});var p=r.Me=e.extend({init:function(t){this.wr(t)},toString:function(t){return(t||this.Be).stringify(this)}}),w=(n.format={}).Ie={stringify:function(t){var n=t.ciphertext,i=t.Ce;return(i?o.create([1398893684,1701076831]).concat(i).concat(n):n).toString(a)},parse:function(t){var n,i=a.parse(t),r=i._r;return 1398893684==r[0]&&1701076831==r[1]&&(n=o.create(r.slice(2,4)),r.splice(0,4),i.mr-=16),p.create({ciphertext:i,Ce:n})}},b=r.Fe=e.extend({Fr:e.extend({format:w}),encrypt:function(t,n,i,r){r=this.Fr.extend(r);var e=t.se(i,r),o=e.Rr(n),s=e.Fr;return p.create({ciphertext:o,key:i,Se:s.Se,algorithm:t,mode:s.mode,padding:s.padding,blockSize:t.blockSize,Be:r.format})},decrypt:function(t,n,i,r){return r=this.Fr.extend(r),n=this.xe(n,r.format),t.ae(i,r).Rr(n.ciphertext)},xe:function(t,n){return"string"==typeof t?n.parse(t,this):t}}),y=(n.Te={}).Ie={Re:function(t,n,i,r){r||(r=o.random(8));var e=c.create({ne:n+i}).ee(t,r),s=o.create(e._r.slice(n),4*i);return e.mr=4*n,p.create({key:e,Se:s,Ce:r})}},_=r.Ne=b.extend({Fr:b.Fr.extend({Te:y}),encrypt:function(t,n,i,r){var e=(r=this.Fr.extend(r)).Te.Re(i,t.ne,t.ve);r.Se=e.Se;var o=b.encrypt.call(this,t,n,e.key,r);return o.wr(e),o},decrypt:function(t,n,i,r){r=this.Fr.extend(r),n=this.xe(n,r.format);var e=r.Te.Re(i,t.ne,t.ve,n.Ce);return r.Se=e.Se,b.decrypt.call(this,t,n,e.key,r)}})}())}(Jt),function(t,n){var i;t.exports=(i=Tt.exports,function(){var t=i,n=t.dr.ke,r=t.Vr,e=[],o=[],s=[],u=[],a=[],c=[],h=[],f=[],v=[],l=[];!function(){for(var t=[],n=0;n<256;n++)t[n]=n<128?n<<1:n<<1^283;var i=0,r=0;for(n=0;n<256;n++){var d=r^r<<1^r<<2^r<<3^r<<4;d=d>>>8^255&d^99,e[i]=d,o[d]=i;var p=t[i],w=t[p],b=t[w],y=257*t[d]^16843008*d;s[i]=y<<24|y>>>8,u[i]=y<<16|y>>>16,a[i]=y<<8|y>>>24,c[i]=y,y=16843009*b^65537*w^257*p^16843008*i,h[d]=y<<24|y>>>8,f[d]=y<<16|y>>>16,v[d]=y<<8|y>>>24,l[d]=y,i?(i=p^t[t[t[b^p]]],r^=t[t[r]]):i=r=1}}();var d=[0,1,2,4,8,16,32,64,128,27,54],p=r.ze=n.extend({Tr:function(){if(!this.Ke||this.Ue!==this.fe){for(var t=this.Ue=this.fe,n=t._r,i=t.mr/4,r=4*((this.Ke=i+6)+1),o=this.Ve=[],s=0;s<r;s++)s<i?o[s]=n[s]:(c=o[s-1],s%i?i>6&&s%i==4&&(c=e[c>>>24]<<24|e[c>>>16&255]<<16|e[c>>>8&255]<<8|e[255&c]):(c=e[(c=c<<8|c>>>24)>>>24]<<24|e[c>>>16&255]<<16|e[c>>>8&255]<<8|e[255&c],c^=d[s/i|0]<<24),o[s]=o[s-i]^c);for(var u=this.Je=[],a=0;a<r;a++){if(s=r-a,a%4)var c=o[s];else c=o[s-4];u[a]=a<4||s<=4?c:h[e[c>>>24]]^f[e[c>>>16&255]]^v[e[c>>>8&255]]^l[e[255&c]]}}},Ee:function(t,n){this.We(t,n,this.Ve,s,u,a,c,e)},je:function(t,n){var i=t[n+1];t[n+1]=t[n+3],t[n+3]=i,this.We(t,n,this.Je,h,f,v,l,o),i=t[n+1],t[n+1]=t[n+3],t[n+3]=i},We:function(t,n,i,r,e,o,s,u){for(var a=this.Ke,c=t[n]^i[0],h=t[n+1]^i[1],f=t[n+2]^i[2],v=t[n+3]^i[3],l=4,d=1;d<a;d++){var p=r[c>>>24]^e[h>>>16&255]^o[f>>>8&255]^s[255&v]^i[l++],w=r[h>>>24]^e[f>>>16&255]^o[v>>>8&255]^s[255&c]^i[l++],b=r[f>>>24]^e[v>>>16&255]^o[c>>>8&255]^s[255&h]^i[l++],y=r[v>>>24]^e[c>>>16&255]^o[h>>>8&255]^s[255&f]^i[l++];c=p,h=w,f=b,v=y}p=(u[c>>>24]<<24|u[h>>>16&255]<<16|u[f>>>8&255]<<8|u[255&v])^i[l++],w=(u[h>>>24]<<24|u[f>>>16&255]<<16|u[v>>>8&255]<<8|u[255&c])^i[l++],b=(u[f>>>24]<<24|u[v>>>16&255]<<16|u[c>>>8&255]<<8|u[255&h])^i[l++],y=(u[v>>>24]<<24|u[c>>>16&255]<<16|u[h>>>8&255]<<8|u[255&f])^i[l++],t[n]=p,t[n+1]=w,t[n+2]=b,t[n+3]=y},ne:8});t.ze=n.zr(p)}(),i.ze)}(xt);var Wt={exports:{}};!function(t,n){t.exports=Tt.exports.Er.Dr}(Wt);var qt={exports:{}};!function(t,n){t.exports=Tt.exports.pad.Oe}(qt),Object.defineProperty(Ft,"t",{value:!0}),Ft.qe=void 0;var Xt=l,Gt=Xt.W(xt.exports),Ht=Xt.W(Wt.exports),Lt=Xt.W(qt.exports);function Qt(t,n){var i="object"==typeof n?n=JSON.stringify(n):n,r=Ht.default.parse(""),e=Ht.default.parse(t);return n=Ht.default.parse(n),Gt.default.encrypt(i,e,{Se:r,padding:Lt.default}).toString()}Ft.qe=Qt;var Zt={Wi:function(t,n){t.Ji({name:"plugin-encrypt-aes",event:"event-body-encrypt",Vi:function(t){var i=t.Xn,r=t.si,e=t.dwProcess.Tt.getAll();(e.dbg||e.debugMode)&&e.rt?i.ci=JSON.stringify(r):i.ht()||(i.ci=Qt(n.Xe,r))}})}};Ft.default=Zt;var Yt,$t={};function tn(t,n,i){null!=t&&("number"==typeof t?this.Ge(t,n,i):null==n&&"string"!=typeof t?this.He(t,256):this.He(t,n))}function nn(){return new tn(null)}Object.defineProperty($t,"t",{value:!0}),$t.Le=$t.Qe=void 0,"Microsoft Internet Explorer"==navigator.appName?(tn.prototype.Ze=function(t,n,i,r,e,o){for(var s=32767&n,u=n>>15;--o>=0;){var a=32767&this[t],c=this[t++]>>15,h=u*a+c*s;e=((a=s*a+((32767&h)<<15)+i[r]+(1073741823&e))>>>30)+(h>>>15)+u*c+(e>>>30),i[r++]=1073741823&a}return e},Yt=30):"Netscape"!=navigator.appName?(tn.prototype.Ze=function(t,n,i,r,e,o){for(;--o>=0;){var s=n*this[t++]+i[r]+e;e=Math.floor(s/67108864),i[r++]=67108863&s}return e},Yt=26):(tn.prototype.Ze=function(t,n,i,r,e,o){for(var s=16383&n,u=n>>14;--o>=0;){var a=16383&this[t],c=this[t++]>>14,h=u*a+c*s;e=((a=s*a+((16383&h)<<14)+i[r]+e)>>28)+(h>>14)+u*c,i[r++]=268435455&a}return e},Yt=28),tn.prototype.Ye=Yt,tn.prototype.$e=(1<<Yt)-1,tn.prototype.no=1<<Yt;tn.prototype.io=Math.pow(2,52),tn.prototype.ro=52-Yt,tn.prototype.eo=2*Yt-52;var rn,en,on=new Array;for(rn="0".charCodeAt(0),en=0;en<=9;++en)on[rn++]=en;for(rn="a".charCodeAt(0),en=10;en<36;++en)on[rn++]=en;for(rn="A".charCodeAt(0),en=10;en<36;++en)on[rn++]=en;function sn(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function un(t,n){var i=on[t.charCodeAt(n)];return null==i?-1:i}function an(t){var n=nn();return n.oo(t),n}function cn(t){var n,i=1;return 0!=(n=t>>>16)&&(t=n,i+=16),0!=(n=t>>8)&&(t=n,i+=8),0!=(n=t>>4)&&(t=n,i+=4),0!=(n=t>>2)&&(t=n,i+=2),0!=(n=t>>1)&&(t=n,i+=1),i}function hn(t){this.so=t}function fn(t){this.so=t,this.uo=t.ao(),this.co=32767&this.uo,this.ho=this.uo>>15,this.fo=(1<<t.Ye-15)-1,this.vo=2*t.lo}function vn(){this.do=0,this.po=0,this.wo=new Array}hn.prototype.bo=function(t){return t.s<0||t.yo(this.so)>=0?t._o(this.so):t},hn.prototype.mo=function(t){return t},hn.prototype.reduce=function(t){t.Eo(this.so,null,t)},hn.prototype.jo=function(t,n,i){t.Oo(n,i),this.reduce(i)},hn.prototype.Do=function(t,n){t.ko(n),this.reduce(n)},fn.prototype.bo=function(t){var n=nn();return t.abs().So(this.so.lo,n),n.Eo(this.so,null,n),t.s<0&&n.yo(tn.ZERO)>0&&this.so.Ao(n,n),n},fn.prototype.mo=function(t){var n=nn();return t.Po(n),this.reduce(n),n},fn.prototype.reduce=function(t){for(;t.lo<=this.vo;)t[t.lo++]=0;for(var n=0;n<this.so.lo;++n){var i=32767&t[n],r=i*this.co+((i*this.ho+(t[n]>>15)*this.co&this.fo)<<15)&t.$e;for(t[i=n+this.so.lo]+=this.so.Ze(0,r,t,n,0,this.so.lo);t[i]>=t.no;)t[i]-=t.no,t[++i]++}t.gr(),t.Mo(this.so.lo,t),t.yo(this.so)>=0&&t.Ao(this.so,t)},fn.prototype.jo=function(t,n,i){t.Oo(n,i),this.reduce(i)},fn.prototype.Do=function(t,n){t.ko(n),this.reduce(n)},tn.prototype.Po=function(t){for(var n=this.lo-1;n>=0;--n)t[n]=this[n];t.lo=this.lo,t.s=this.s},tn.prototype.oo=function(t){this.lo=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.no:this.lo=0},tn.prototype.He=function(t,n){var i;if(16==n)i=4;else if(8==n)i=3;else if(256==n)i=8;else if(2==n)i=1;else if(32==n)i=5;else{if(4!=n)return void this.Bo(t,n);i=2}this.lo=0,this.s=0;for(var r=t.length,e=!1,o=0;--r>=0;){var s=8==i?255&t[r]:un(t,r);s<0?"-"==t.charAt(r)&&(e=!0):(e=!1,0==o?this[this.lo++]=s:o+i>this.Ye?(this[this.lo-1]|=(s&(1<<this.Ye-o)-1)<<o,this[this.lo++]=s>>this.Ye-o):this[this.lo-1]|=s<<o,(o+=i)>=this.Ye&&(o-=this.Ye))}8==i&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.lo-1]|=(1<<this.Ye-o)-1<<o)),this.gr(),e&&tn.ZERO.Ao(this,this)},tn.prototype.gr=function(){for(var t=this.s&this.$e;this.lo>0&&this[this.lo-1]==t;)--this.lo},tn.prototype.So=function(t,n){var i;for(i=this.lo-1;i>=0;--i)n[i+t]=this[i];for(i=t-1;i>=0;--i)n[i]=0;n.lo=this.lo+t,n.s=this.s},tn.prototype.Mo=function(t,n){for(var i=t;i<this.lo;++i)n[i-t]=this[i];n.lo=Math.max(this.lo-t,0),n.s=this.s},tn.prototype.Io=function(t,n){var i,r=t%this.Ye,e=this.Ye-r,o=(1<<e)-1,s=Math.floor(t/this.Ye),u=this.s<<r&this.$e;for(i=this.lo-1;i>=0;--i)n[i+s+1]=this[i]>>e|u,u=(this[i]&o)<<r;for(i=s-1;i>=0;--i)n[i]=0;n[s]=u,n.lo=this.lo+s+1,n.s=this.s,n.gr()},tn.prototype.Co=function(t,n){n.s=this.s;var i=Math.floor(t/this.Ye);if(i>=this.lo)n.lo=0;else{var r=t%this.Ye,e=this.Ye-r,o=(1<<r)-1;n[0]=this[i]>>r;for(var s=i+1;s<this.lo;++s)n[s-i-1]|=(this[s]&o)<<e,n[s-i]=this[s]>>r;r>0&&(n[this.lo-i-1]|=(this.s&o)<<e),n.lo=this.lo-i,n.gr()}},tn.prototype.Ao=function(t,n){for(var i=0,r=0,e=Math.min(t.lo,this.lo);i<e;)r+=this[i]-t[i],n[i++]=r&this.$e,r>>=this.Ye;if(t.lo<this.lo){for(r-=t.s;i<this.lo;)r+=this[i],n[i++]=r&this.$e,r>>=this.Ye;r+=this.s}else{for(r+=this.s;i<t.lo;)r-=t[i],n[i++]=r&this.$e,r>>=this.Ye;r-=t.s}n.s=r<0?-1:0,r<-1?n[i++]=this.no+r:r>0&&(n[i++]=r),n.lo=i,n.gr()},tn.prototype.Oo=function(t,n){var i=this.abs(),r=t.abs(),e=i.lo;for(n.lo=e+r.lo;--e>=0;)n[e]=0;for(e=0;e<r.lo;++e)n[e+i.lo]=i.Ze(0,r[e],n,e,0,i.lo);n.s=0,n.gr(),this.s!=t.s&&tn.ZERO.Ao(n,n)},tn.prototype.ko=function(t){for(var n=this.abs(),i=t.lo=2*n.lo;--i>=0;)t[i]=0;for(i=0;i<n.lo-1;++i){var r=n.Ze(i,n[i],t,2*i,0,1);(t[i+n.lo]+=n.Ze(i+1,2*n[i],t,2*i+1,r,n.lo-i-1))>=n.no&&(t[i+n.lo]-=n.no,t[i+n.lo+1]=1)}t.lo>0&&(t[t.lo-1]+=n.Ze(i,n[i],t,2*i,0,1)),t.s=0,t.gr()},tn.prototype.Eo=function(t,n,i){var r=t.abs();if(!(r.lo<=0)){var e=this.abs();if(e.lo<r.lo)return null!=n&&n.oo(0),void(null!=i&&this.Po(i));null==i&&(i=nn());var o=nn(),s=this.s,u=t.s,a=this.Ye-cn(r[r.lo-1]);a>0?(r.Io(a,o),e.Io(a,i)):(r.Po(o),e.Po(i));var c=o.lo,h=o[c-1];if(0!=h){var f=h*(1<<this.ro)+(c>1?o[c-2]>>this.eo:0),v=this.io/f,l=(1<<this.ro)/f,d=1<<this.eo,p=i.lo,w=p-c,b=null==n?nn():n;for(o.So(w,b),i.yo(b)>=0&&(i[i.lo++]=1,i.Ao(b,i)),tn.ONE.So(c,b),b.Ao(o,o);o.lo<c;)o[o.lo++]=0;for(;--w>=0;){var y=i[--p]==h?this.$e:Math.floor(i[p]*v+(i[p-1]+d)*l);if((i[p]+=o.Ze(0,y,i,w,0,c))<y)for(o.So(w,b),i.Ao(b,i);i[p]<--y;)i.Ao(b,i)}null!=n&&(i.Mo(c,n),s!=u&&tn.ZERO.Ao(n,n)),i.lo=c,i.gr(),a>0&&i.Co(a,i),s<0&&tn.ZERO.Ao(i,i)}}},tn.prototype.ao=function(){if(this.lo<1)return 0;var t=this[0];if(0==(1&t))return 0;var n=3&t;return(n=(n=(n=(n=n*(2-(15&t)*n)&15)*(2-(255&t)*n)&255)*(2-((65535&t)*n&65535))&65535)*(2-t*n%this.no)%this.no)>0?this.no-n:-n},tn.prototype.Fo=function(){return 0==(this.lo>0?1&this[0]:this.s)},tn.prototype.exp=function(t,n){if(t>4294967295||t<1)return tn.ONE;var i=nn(),r=nn(),e=n.bo(this),o=cn(t)-1;for(e.Po(i);--o>=0;)if(n.Do(i,r),(t&1<<o)>0)n.jo(r,e,i);else{var s=i;i=r,r=s}return n.mo(i)},tn.prototype.toString=function(t){if(this.s<0)return"-"+this.xo().toString(t);var n;if(16==t)n=4;else if(8==t)n=3;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return this.To(t);n=2}var i,r=(1<<n)-1,e=!1,o="",s=this.lo,u=this.Ye-s*this.Ye%n;if(s-- >0)for(u<this.Ye&&(i=this[s]>>u)>0&&(e=!0,o=sn(i));s>=0;)u<n?(i=(this[s]&(1<<u)-1)<<n-u,i|=this[--s]>>(u+=this.Ye-n)):(i=this[s]>>(u-=n)&r,u<=0&&(u+=this.Ye,--s)),i>0&&(e=!0),e&&(o+=sn(i));return e?o:"0"},tn.prototype.xo=function(){var t=nn();return tn.ZERO.Ao(this,t),t},tn.prototype.abs=function(){return this.s<0?this.xo():this},tn.prototype.yo=function(t){var n=this.s-t.s;if(0!=n)return n;var i=this.lo;if(0!=(n=i-t.lo))return this.s<0?-n:n;for(;--i>=0;)if(0!=(n=this[i]-t[i]))return n;return 0},tn.prototype.Ro=function(){return this.lo<=0?0:this.Ye*(this.lo-1)+cn(this[this.lo-1]^this.s&this.$e)},tn.prototype._o=function(t){var n=nn();return this.abs().Eo(t,null,n),this.s<0&&n.yo(tn.ZERO)>0&&t.Ao(n,n),n},tn.prototype.No=function(t,n){var i;return i=t<256||n.Fo()?new hn(n):new fn(n),this.exp(t,i)},tn.ZERO=an(0),tn.ONE=an(1),vn.prototype.init=function(t){var n,i,r;for(n=0;n<256;++n)this.wo[n]=n;for(i=0,n=0;n<256;++n)i=i+this.wo[n]+t[n%t.length]&255,r=this.wo[n],this.wo[n]=this.wo[i],this.wo[i]=r;this.do=0,this.po=0},vn.prototype.next=function(){var t;return this.do=this.do+1&255,this.po=this.po+this.wo[this.do]&255,t=this.wo[this.do],this.wo[this.do]=this.wo[this.po],this.wo[this.po]=t,this.wo[t+this.wo[this.do]&255]};var ln,dn,pn;function wn(){var t;t=(new Date).getTime(),dn[pn++]^=255&t,dn[pn++]^=t>>8&255,dn[pn++]^=t>>16&255,dn[pn++]^=t>>24&255,pn>=256&&(pn-=256)}if(null==dn){dn=new Array,pn=0;var bn=void 0;if(window.crypto&&window.crypto.getRandomValues){var yn=new Uint8Array(32);for(window.crypto.getRandomValues(yn),bn=0;bn<32;++bn)dn[pn++]=yn[bn]}if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto&&window.crypto.random){var _n=window.crypto.random(32);for(bn=0;bn<_n.length;++bn)dn[pn++]=255&_n.charCodeAt(bn)}for(;pn<256;)bn=Math.floor(65536*Math.random()),dn[pn++]=bn>>>8,dn[pn++]=255&bn;pn=0,wn()}function mn(){if(null==ln){for(wn(),(ln=new vn).init(dn),pn=0;pn<dn.length;++pn)dn[pn]=0;pn=0}return ln.next()}function gn(){}function En(){this.n=null,this.e=0,this.d=null,this.zo=null,this.Ko=null,this.Uo=null,this.Vo=null,this.Jo=null}gn.prototype.Wo=function(t){var n;for(n=0;n<t.length;++n)t[n]=mn()},En.prototype.qo=function(t){return t.No(this.e,this.n)},En.prototype.Xo=function(t,n){null!=t&&null!=n&&t.length>0&&n.length>0?(this.n=new tn(t,16),this.e=parseInt(n,16)):alert("Invalid RSA public key")},En.prototype.encrypt=function(t){var n=function(t,n){if(n<t.length+11)return alert("Message too long for RSA"),null;for(var i=new Array,r=t.length-1;r>=0&&n>0;){var e=t.charCodeAt(r--);e<128?i[--n]=e:e>127&&e<2048?(i[--n]=63&e|128,i[--n]=e>>6|192):(i[--n]=63&e|128,i[--n]=e>>6&63|128,i[--n]=e>>12|224)}i[--n]=0;for(var o=new gn,s=new Array;n>2;){for(s[0]=0;0==s[0];)o.Wo(s);i[--n]=s[0]}return i[--n]=2,i[--n]=0,new tn(i)}(t,this.n.Ro()+7>>3);if(null==n)return null;var i=this.qo(n);if(null==i)return null;var r=i.toString(16);return 0==(1&r.length)?r:"0"+r};var jn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";$t.Qe=function(t){var n,i,r="";for(n=0;n+3<=t.length;n+=3)i=parseInt(t.substring(n,n+3),16),r+=jn.charAt(i>>6)+jn.charAt(63&i);for(n+1==t.length?(i=parseInt(t.substring(n,n+1),16),r+=jn.charAt(i<<2)):n+2==t.length&&(i=parseInt(t.substring(n,n+2),16),r+=jn.charAt(i>>2)+jn.charAt((3&i)<<4));(3&r.length)>0;)r+="=";return r},$t.Le=function(t,n){for(var i="",r=0;r+n<t.length;)i+=t.substring(r,r+n),r+=n;return i+t.substring(r,t.length)},$t.default=En;var On={};Object.defineProperty(On,"t",{value:!0}),On.Go=void 0,On.Go=function(t){void 0===t&&(t=32);for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i=n.length,r="",e=0;e<t;e++)r+=n.charAt(Math.floor(Math.random()*i));return r},function(t){Object.defineProperty(t,"t",{value:!0}),t.Ho=t.Lo=t.qe=void 0;var n=l,i=n.J(Ft),r=n.J($t),e=On,o=Ft;function s(t,n){if(r.default&&r.Le&&r.Qe){var i=0,e=function(t,n){var o=new r.default;o.Xo(t,"10001");var s=o.encrypt(n);return 344!==(s=r.Le(r.Qe(s),64)).length&&i<10&&(i++,s=e(t,n)),i=0,s};return e(t,n)}return n}function u(t,n,r){for(var o=Object.assign({},t),u=e.Go(16),a=0,c=n.length;a<c;a++){var h=n[a],f=o[h];null!=f&&(o[h]=i.qe(u,String(f)))}return{Qo:o,Zo:s(r,u)}}Object.defineProperty(t,"qe",{i:!0,get:function(){return o.qe}}),t.Lo=s,t.Ho=u;var a={Wi:function(t,n){t.Ji({name:"plugin-encrypt-web",event:"event-data-encrypt",Vi:function(t){var i,r,e,o=t.Xn,s=t.dwProcess;o.validate();var a=s.Tt.getAll();if((a.dbg||a.debugMode)&&a.rt)o.qn=o.data;else{var c,h=null!==(e=null===(r=null===(i=s.Jt)||void 0===i?void 0:i.events)||void 0===r?void 0:r.data)&&void 0!==e?e:[];if("_page_view"===o.name)c=["title","url","refer"];else for(var f=0;f<h.length;f++){var v=h[f];if(v.name===o.name){v.encryptAttrs&&(c=v.encryptAttrs);break}}if(c&&o.data){var l=u(o.data,c,n.Yo),d=l.Qo,p=l.Zo;if(p){var w={_encrypted_key:p,_encrypted_version:"20160113",_encrypted_fields:c.join(",")};Object.assign(d,w)}o.qn=d}}}}),i.default.Wi(t,{Xe:n.Xe})}};t.default=a}(Ct);var Dn={};Object.defineProperty(Dn,"t",{value:!0});Dn.default={Wi:function(t,n){var i=0,r=n.max;t.Ji({name:"send-in-limit-connect-before-event",event:"before-event-send",Vi:function(t){var n=t.Xn;n.ht()||(i>=r?n.li().ut():i++)}}),t.Ji({name:"send-in-limit-connect-after-event",event:"after-event-send",Vi:function(t){t.dwProcess,i>0&&i--}}),t.Ji({name:"send-in-limit-connect-before-dynamic",event:"before-dynamic-send",Vi:function(t){var n=t.Kt;n.ht()||(i>=r?(n.retry(),n.ut()):i++)}}),t.Ji({name:"send-in-limit-connect-after-dynamic",event:"after-dynamic-send",Vi:function(){i>0&&i--}})}};var kn={};Object.defineProperty(kn,"t",{value:!0});var Sn={Wi:function(t,n){var i=null!=n?n:{},r=i.$o,e=void 0===r?0:r,o=i.ts,s=void 0===o?0:o,u=i.ns,a=void 0===u?[]:u;t.Ji({name:"plugin-send-in-throttle",event:"before-event-send",Vi:function(t){var n=t.Xn,i=t.dwProcess;i.cache.tn.ts||(i.cache.tn.ts={rs:!1,es:null,ss:null});var r=i.Zt,o=i.cache.tn.ts;if(!n.ht()&&"wait"!==n.from&&!a.includes(n.name)){var u=function(){o.rs=!1,clearTimeout(o.es),clearTimeout(o.ss),o.es=null,o.ss=null,r.Cn(i)};e>0&&(n.li().ut(),clearTimeout(o.es),o.es=setTimeout(u,e)),s>0&&(o.rs||(o.rs=!0,clearTimeout(o.ss),o.ss=setTimeout(u,s)))}}})}};kn.default=Sn,Object.defineProperty(e,"t",{value:!0}),e.us=void 0;var An=l,Pn=An.W(d.exports),Mn=An.W(p),Bn=w,In=_t,Cn=kt,Fn=Bt,xn=An.W(Ct),Tn=An.W(Dn),Rn=An.W(kn),Nn=M;Bn.tt.Vt.Ut=new In.Zi,Bn.tt.Vt.en=new Cn.nr,Bn.tt.Vt.storage=new Fn.hr,Bn.tt.it={dynamicUrl:"https://dw-online.ksosoft.com",sendUrl:"(https://shuc-js.ksord.com/bat/js/cors)",debugUrl:"(https://dw-collect-debug.ksord.com)",Bn:function(t,n){if(!n.An){var i=t.At,r=function(){if("function"==typeof navigator.sendBeacon){var n=t._n();if("boolean"==typeof navigator.onLine&&!navigator.onLine)return n.fi(),void i.di.sync();var r=Pn.default.encode(Mn.default.encode(JSON.stringify(n.si))),e=new Blob([r],{type:"application/x-www-form-urlencoded"}),o=n.Vn[0];t.Tn()&&(console.log("beacon url",o),console.log("beacon body",JSON.stringify(n.si))),navigator.sendBeacon("string"==typeof o?o:o[0],e)}else console.log('[dw-js-sdk] "sendBeacon" is not supported, use normal method to send app_end.'),t.jn()};"onbeforeunload"in window?window.addEventListener("beforeunload",r,!1):window.addEventListener("pagehide",r,!1)}}},Bn.tt.use(xn.default,{Xe:"ZctYg7JjXcPySXxw",Yo:"8762DEC337D703A5841A8090180350203AC0C2809A864BF6CA31979FCD7AA3D1BFA38CF8B243878984CBC9B83496CBAC87B448F74EA7550D579BD5820EFD17F5D22D0665AB114FB6EBA74261B4EB040828FBCA7CF95EF0D56BBFD9C67E5941AFFB34DE4C6FA2E737C16D9C703A43D90F65B40E7F3E44C1165C1ED3BD10BC449421863174E8EFA3CA618E0DEE7EDD65F07AAE0586AB1702B1D95F29F3BA447AD744E9B37ACB3F510D068A2D6BDBE4F0689B26A9AFCF66219160E7CF802D2F1A56503F462693B62747AD4163DBC1222687D154C53C03BBB5D2DE9ABC2DE6907E3B26E45C4FCA63F28258C4D07D3E152AE51F80A0DA7B77A3E1D0EFE72A988B57F9"}),Bn.tt.use(Rn.default,{$o:parseInt("300"),ts:parseInt("5000"),ns:["_app_end"]}),Bn.tt.use(Tn.default,{max:3});var zn=function(t){function n(n){void 0===n&&(n={});var i=t.call(this,n)||this;i.options=n;var r=new Date;return i.cs=[r.getFullYear(),r.getMonth()+1,r.getDate()],i}return An.v(n,t),n.prototype.createReporter=function(t,i){if(!t)throw Error("createReporter requires param appKey.");return new n(i).setAppKey(t)},n.prototype.setDailyFresh=function(t){var n=this;void 0===t&&(t="00:15");var i=t.match(/(\d?\d):(\d?\d)/),r="请设置正确的时间格式 hh:mm";if(!i)throw Error(r);var e=parseInt(i[1]),o=parseInt(i[2]);if(e>24||o>60)throw Error(r);var s=this.dwProcess.It();if(Nn.Qt.vn("WebReporter","setDailyFresh",t),s){var u=new Date(s),a=parseInt("21600000 # 6小时");u.setHours(e),u.setMinutes(o),u.setSeconds(0,0),u.setTime(u.getTime()+Math.random()*a);var c=u.getTime()-s.getTime(),h=864e5,f=c>0?c:c+h,v=function(){n.dwProcess.refresh(),n.hs=setTimeout(v,h)};clearTimeout(this.hs),this.hs=setTimeout(v,f)}else setTimeout((function(){return n.setDailyFresh(t)}),6e4);return this},n.prototype.forceFresh=function(){var t=new Date,n=[t.getFullYear(),t.getMonth()+1,t.getDate()],i=function(t,n,i){var r=n;return 1===i&&(r*=100),t+r};n.reduce(i)-this.cs.reduce(i)<=0?Nn.Qt.vn("WebReporter","forceFresh","fail: same date",{Mn:n.join("-"),fs:this.cs.join("-")}):(Nn.Qt.vn("WebReporter","forceFresh","success",{Mn:n.join("-"),fs:this.cs.join("-")},!0),this.dwProcess.refresh(!0),this.cs=n)},n}(Bn.tt);return e.us=zn,e.default=zn,function(t){Object.defineProperty(t,"t",{value:!0}),t.dw=void 0;var n=r,i=e;t.dw=function(){var t=window;if(void 0===t._dw)t._dw=t.dw=new i.us({});else{if(console.group("[dw-js-sdk] warn"),void 0===t._dw.version)return console.warn("[dw-js-sdk] 检测到您已引入旧版sdk, 请升级您的版本至v3.0.27或以上"),new i.us({});switch(n.o(t._dw.version)){case-1:console.log("[dw-js-sdk] 检测到新的版本, 请升级您的sdk");break;case 1:console.log("[dw-js-sdk] 检测到当前环境存在旧版本的sdk!")}console.log("[dw-js-sdk] (1/3) 当前环境已存在统计工具 window._dw"),console.log("[dw-js-sdk] (2/3) 可能的原因是存在重复引入 sdk 文件"),console.log('[dw-js-sdk] (3/3) 请使用 window._dw.createReporter("your-app-key") 创建一个新的统计工具'),console.groupEnd()}return t._dw}(),t.default=t.dw}(i),t(i)}));
//# sourceMappingURL=dw-web.min.mangle.js.map
